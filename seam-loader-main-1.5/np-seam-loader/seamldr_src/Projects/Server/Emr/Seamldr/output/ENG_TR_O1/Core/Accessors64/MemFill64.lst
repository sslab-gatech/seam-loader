     0                                   ;;; %define __?FILE?__ 
     0                                   ;;; %define __?LINE?__ 
     0                                   ;;; %define __?BITS?__ 
     0                                   ;;; %define __?PTR?__ 
     0                                   ;;; %define __?PASS?__ 2
     0                              <1> %define __?SECT?__
     0                              <1>  ;;; %define __?SECT?__ 
     0                              <1> %defalias __SECT__ __?SECT?__
     0                              <1>  ;;; %defalias __SECT__ __?SECT?__
     0                              <1> %imacro section 1+.nolist
     0                              <1> %define __?SECT?__ [section %1]
     0                              <1> __?SECT?__
     0                              <1> %endmacro 
     0                              <1> %imacro segment 1+.nolist
     0                              <1> %define __?SECT?__ [segment %1]
     0                              <1> __?SECT?__
     0                              <1> %endmacro 
     0                              <1> %define __?SECTALIGN_ALIGN_UPDATES_SECTION?__ 1
     0                              <1>  ;;; %define __?SECTALIGN_ALIGN_UPDATES_SECTION?__ 1
     0                              <1> %imacro sectalign 1+.nolist
     0                              <1> %ifidni %1,off
     0                              <1> %define __?SECTALIGN_ALIGN_UPDATES_SECTION?__ 0
     0                              <1> %elifidni %1,on
     0                              <1> %define __?SECTALIGN_ALIGN_UPDATES_SECTION?__ 1
     0                              <1> %else 
     0                              <1> [sectalign %1]
     0                              <1> %endif 
     0                              <1> %endmacro 
     0                              <1> %defalias __SECTALIGN_ALIGN_UPDATES_SECTION__ __?SECTALIGN_ALIGN_UPDATES_SECTION?__
     0                              <1>  ;;; %defalias __SECTALIGN_ALIGN_UPDATES_SECTION__ __?SECTALIGN_ALIGN_UPDATES_SECTION?__
     0                              <1> %imacro absolute 1+.nolist
     0                              <1> %define __?SECT?__ [absolute %1]
     0                              <1> __?SECT?__
     0                              <1> %endmacro 
     0                              <1> %imacro struc 1-2.nolist 0
     0                              <1> %push 
     0                              <1> %define %$strucname %1
     0                              <1> [absolute %2]
     0                              <1> %$strucname:
     0                              <1> %endmacro 
     0                              <1> %imacro endstruc 0.nolist
     0                              <1> %{$strucname}_size equ ($-%$strucname)
     0                              <1> %pop 
     0                              <1> __?SECT?__
     0                              <1> %endmacro 
     0                              <1> %imacro istruc 1.nolist
     0                              <1> %push 
     0                              <1> %define %$strucname %1
     0                              <1> %$strucstart:
     0                              <1> %endmacro 
     0                              <1> %imacro at 1-2+.nolist
     0                              <1> times (%1-%$strucname)-($-%$strucstart) db 0
     0                              <1> %2
     0                              <1> %endmacro 
     0                              <1> %imacro iend 0.nolist
     0                              <1> times %{$strucname}_size-($-%$strucstart) db 0
     0                              <1> %pop 
     0                              <1> %endmacro 
     0                              <1> %imacro align 1-2+.nolist nop
     0                              <1> %if __?SECTALIGN_ALIGN_UPDATES_SECTION?__
     0                              <1> sectalign %1
     0                              <1> %endif 
     0                              <1> times (((%1) - (($-$$) % (%1))) % (%1)) %2
     0                              <1> %endmacro 
     0                              <1> %imacro alignb 1-2+.nolist
     0                              <1> %if __?SECTALIGN_ALIGN_UPDATES_SECTION?__
     0                              <1> sectalign %1
     0                              <1> %endif 
     0                              <1> %ifempty %2
     0                              <1> [warning push]
     0                              <1> [warning -zeroing]
     0                              <1> resb (((%1) - (($-$$) % (%1))) % (%1))
     0                              <1> [warning pop]
     0                              <1> %else 
     0                              <1> times (((%1) - (($-$$) % (%1))) % (%1)) %2
     0                              <1> %endif 
     0                              <1> %endmacro 
     0                              <1> %imacro bits 1+.nolist
     0                              <1> [bits %1]
     0                              <1> %endmacro 
     0                              <1> %imacro use16 0.nolist
     0                              <1> [bits 16]
     0                              <1> %endmacro 
     0                              <1> %imacro use32 0.nolist
     0                              <1> [bits 32]
     0                              <1> %endmacro 
     0                              <1> %imacro use64 0.nolist
     0                              <1> [bits 64]
     0                              <1> %endmacro 
     0                              <1> %imacro extern 1-*.nolist
     0                              <1> %rep %0
     0                              <1> [extern %1]
     0                              <1> %rotate 1
     0                              <1> %endrep 
     0                              <1> %endmacro 
     0                              <1> %imacro static 1-*.nolist
     0                              <1> %rep %0
     0                              <1> [static %1]
     0                              <1> %rotate 1
     0                              <1> %endrep 
     0                              <1> %endmacro 
     0                              <1> %imacro global 1-*.nolist
     0                              <1> %rep %0
     0                              <1> [global %1]
     0                              <1> %rotate 1
     0                              <1> %endrep 
     0                              <1> %endmacro 
     0                              <1> %imacro required 1-*.nolist
     0                              <1> %rep %0
     0                              <1> [required %1]
     0                              <1> %rotate 1
     0                              <1> %endrep 
     0                              <1> %endmacro 
     0                              <1> %imacro common 1-*.nolist
     0                              <1> %rep %0
     0                              <1> [common %1]
     0                              <1> %rotate 1
     0                              <1> %endrep 
     0                              <1> %endmacro 
     0                              <1> %imacro cpu 1+.nolist
     0                              <1> [cpu %1]
     0                              <1> %endmacro 
     0                              <1> %define __?FLOAT_DAZ?__ nodaz
     0                              <1>  ;;; %define __?FLOAT_DAZ?__ nodaz
     0                              <1> %define __?FLOAT_ROUND?__ near
     0                              <1>  ;;; %define __?FLOAT_ROUND?__ near
     0                              <1> %define __?FLOAT?__ __?FLOAT_DAZ?__,__?FLOAT_ROUND?__
     0                              <1>  ;;; %define __?FLOAT?__ __?FLOAT_DAZ?__,__?FLOAT_ROUND?__
     0                              <1> %defalias __FLOAT_DAZ__ __?FLOAT_DAZ?__
     0                              <1>  ;;; %defalias __FLOAT_DAZ__ __?FLOAT_DAZ?__
     0                              <1> %defalias __FLOAT_ROUND__ __?FLOAT_ROUND?__
     0                              <1>  ;;; %defalias __FLOAT_ROUND__ __?FLOAT_ROUND?__
     0                              <1> %defalias __FLOAT__ __?FLOAT?__
     0                              <1>  ;;; %defalias __FLOAT__ __?FLOAT?__
     0                              <1> %imacro float 1-*.nolist
     0                              <1> %rep %0
     0                              <1> [float %1]
     0                              <1> %ifidni %1,daz
     0                              <1> %define __?FLOAT_DAZ?__ daz
     0                              <1> %elifidni %1,nodaz
     0                              <1> %define __?FLOAT_DAZ?__ nodaz
     0                              <1> %elifidni %1,near
     0                              <1> %define __?FLOAT_ROUND?__ near
     0                              <1> %elifidni %1,up
     0                              <1> %define __?FLOAT_ROUND?__ up
     0                              <1> %elifidni %1,down
     0                              <1> %define __?FLOAT_ROUND?__ down
     0                              <1> %elifidni %1,zero
     0                              <1> %define __?FLOAT_ROUND?__ zero
     0                              <1> %elifidni %1,default
     0                              <1> %define __?FLOAT_DAZ?__ nodaz
     0                              <1> %define __?FLOAT_ROUND?__ near
     0                              <1> %endif 
     0                              <1> %rotate 1
     0                              <1> %endrep 
     0                              <1> %endmacro 
     0                              <1> %imacro default 1+.nolist
     0                              <1> [default %1]
     0                              <1> %endmacro 
     0                              <1> %imacro userel 0.nolist
     0                              <1> [default rel]
     0                              <1> %endmacro 
     0                              <1> %imacro useabs 0.nolist
     0                              <1> [default abs]
     0                              <1> %endmacro 
     0                              <1> %imacro usebnd 0.nolist
     0                              <1> [default bnd]
     0                              <1> %endmacro 
     0                              <1> %imacro usenobnd 0.nolist
     0                              <1> [default nobnd]
     0                              <1> %endmacro 
     0                              <1> %imacro incbin 1-2+.nolist 0
     0                              <1> %push 
     0                              <1> %pathsearch %$dep %1
     0                              <1> %depend %$dep
     0                              <1> %? %$dep,%2
     0                              <1> %pop 
     0                              <1> %endmacro 
     0                              <1> %defalias __NASM_MAJOR__ __?NASM_MAJOR?__
     0                              <1>  ;;; %defalias __NASM_MAJOR__ __?NASM_MAJOR?__
     0                              <1> %defalias __NASM_MINOR__ __?NASM_MINOR?__
     0                              <1>  ;;; %defalias __NASM_MINOR__ __?NASM_MINOR?__
     0                              <1> %defalias __NASM_SUBMINOR__ __?NASM_SUBMINOR?__
     0                              <1>  ;;; %defalias __NASM_SUBMINOR__ __?NASM_SUBMINOR?__
     0                              <1> %defalias __NASM_PATCHLEVEL__ __?NASM_PATCHLEVEL?__
     0                              <1>  ;;; %defalias __NASM_PATCHLEVEL__ __?NASM_PATCHLEVEL?__
     0                              <1> %defalias __NASM_SNAPSHOT__ __?NASM_SNAPSHOT?__
     0                              <1>  ;;; %defalias __NASM_SNAPSHOT__ __?NASM_SNAPSHOT?__
     0                              <1> %defalias __NASM_VERSION_ID__ __?NASM_VERSION_ID?__
     0                              <1>  ;;; %defalias __NASM_VERSION_ID__ __?NASM_VERSION_ID?__
     0                              <1> %defalias __NASM_VER__ __?NASM_VER?__
     0                              <1>  ;;; %defalias __NASM_VER__ __?NASM_VER?__
     0                              <1> %defalias __OUTPUT_FORMAT__ __?OUTPUT_FORMAT?__
     0                              <1>  ;;; %defalias __OUTPUT_FORMAT__ __?OUTPUT_FORMAT?__
     0                              <1> %defalias __DEBUG_FORMAT__ __?DEBUG_FORMAT?__
     0                              <1>  ;;; %defalias __DEBUG_FORMAT__ __?DEBUG_FORMAT?__
     0                              <1> %defalias __DATE__ __?DATE?__
     0                              <1>  ;;; %defalias __DATE__ __?DATE?__
     0                              <1> %defalias __DATE_NUM__ __?DATE_NUM?__
     0                              <1>  ;;; %defalias __DATE_NUM__ __?DATE_NUM?__
     0                              <1> %defalias __TIME__ __?TIME?__
     0                              <1>  ;;; %defalias __TIME__ __?TIME?__
     0                              <1> %defalias __TIME_NUM__ __?TIME_NUM?__
     0                              <1>  ;;; %defalias __TIME_NUM__ __?TIME_NUM?__
     0                              <1> %defalias __UTC_DATE__ __?UTC_DATE?__
     0                              <1>  ;;; %defalias __UTC_DATE__ __?UTC_DATE?__
     0                              <1> %defalias __UTC_DATE_NUM__ __?UTC_DATE_NUM?__
     0                              <1>  ;;; %defalias __UTC_DATE_NUM__ __?UTC_DATE_NUM?__
     0                              <1> %defalias __UTC_TIME__ __?UTC_TIME?__
     0                              <1>  ;;; %defalias __UTC_TIME__ __?UTC_TIME?__
     0                              <1> %defalias __UTC_TIME_NUM__ __?UTC_TIME_NUM?__
     0                              <1>  ;;; %defalias __UTC_TIME_NUM__ __?UTC_TIME_NUM?__
     0                              <1> %defalias __POSIX_TIME__ __?POSIX_TIME?__
     0                              <1>  ;;; %defalias __POSIX_TIME__ __?POSIX_TIME?__
     0                              <1> %defalias __FILE__ __?FILE?__
     0                              <1>  ;;; %defalias __FILE__ __?FILE?__
     0                              <1> %defalias __LINE__ __?LINE?__
     0                              <1>  ;;; %defalias __LINE__ __?LINE?__
     0                              <1> %defalias __BITS__ __?BITS?__
     0                              <1>  ;;; %defalias __BITS__ __?BITS?__
     0                              <1> %defalias __PTR__ __?PTR?__
     0                              <1>  ;;; %defalias __PTR__ __?PTR?__
     0                              <1> %defalias __PASS__ __?PASS?__
     0                              <1>  ;;; %defalias __PASS__ __?PASS?__
     0                              <1> %idefine __?infinity?__ %?
     0                              <1>  ;;; %idefine __?infinity?__ %?
     0                              <1> %idefine __?nan?__ %?
     0                              <1>  ;;; %idefine __?nan?__ %?
     0                              <1> %idefine __?qnan?__ %?
     0                              <1>  ;;; %idefine __?qnan?__ %?
     0                              <1> %idefine __?snan?__ %?
     0                              <1>  ;;; %idefine __?snan?__ %?
     0                              <1> %idefine __?float8?__ %?
     0                              <1>  ;;; %idefine __?float8?__ %?
     0                              <1> %idefine __?float16?__ %?
     0                              <1>  ;;; %idefine __?float16?__ %?
     0                              <1> %idefine __?float32?__ %?
     0                              <1>  ;;; %idefine __?float32?__ %?
     0                              <1> %idefine __?float64?__ %?
     0                              <1>  ;;; %idefine __?float64?__ %?
     0                              <1> %idefine __?float80m?__ %?
     0                              <1>  ;;; %idefine __?float80m?__ %?
     0                              <1> %idefine __?float80e?__ %?
     0                              <1>  ;;; %idefine __?float80e?__ %?
     0                              <1> %idefine __?float128l?__ %?
     0                              <1>  ;;; %idefine __?float128l?__ %?
     0                              <1> %idefine __?float128h?__ %?
     0                              <1>  ;;; %idefine __?float128h?__ %?
     0                              <1> %idefine __?utf16?__ %?
     0                              <1>  ;;; %idefine __?utf16?__ %?
     0                              <1> %idefine __?utf16le?__ %?
     0                              <1>  ;;; %idefine __?utf16le?__ %?
     0                              <1> %idefine __?utf16be?__ %?
     0                              <1>  ;;; %idefine __?utf16be?__ %?
     0                              <1> %idefine __?utf32?__ %?
     0                              <1>  ;;; %idefine __?utf32?__ %?
     0                              <1> %idefine __?utf32le?__ %?
     0                              <1>  ;;; %idefine __?utf32le?__ %?
     0                              <1> %idefine __?utf32be?__ %?
     0                              <1>  ;;; %idefine __?utf32be?__ %?
     0                              <1> %idefine __?ilog2e?__ %?
     0                              <1>  ;;; %idefine __?ilog2e?__ %?
     0                              <1> %idefine __?ilog2w?__ %?
     0                              <1>  ;;; %idefine __?ilog2w?__ %?
     0                              <1> %idefine __?ilog2f?__ %?
     0                              <1>  ;;; %idefine __?ilog2f?__ %?
     0                              <1> %idefine __?ilog2c?__ %?
     0                              <1>  ;;; %idefine __?ilog2c?__ %?
     0                              <1> %idefalias __infinity__ __?infinity?__
     0                              <1>  ;;; %idefalias __infinity__ __?infinity?__
     0                              <1> %idefalias __nan__ __?nan?__
     0                              <1>  ;;; %idefalias __nan__ __?nan?__
     0                              <1> %idefalias __qnan__ __?qnan?__
     0                              <1>  ;;; %idefalias __qnan__ __?qnan?__
     0                              <1> %idefalias __snan__ __?snan?__
     0                              <1>  ;;; %idefalias __snan__ __?snan?__
     0                              <1> %idefalias __float8__ __?float8?__
     0                              <1>  ;;; %idefalias __float8__ __?float8?__
     0                              <1> %idefalias __float16__ __?float16?__
     0                              <1>  ;;; %idefalias __float16__ __?float16?__
     0                              <1> %idefalias __float32__ __?float32?__
     0                              <1>  ;;; %idefalias __float32__ __?float32?__
     0                              <1> %idefalias __float64__ __?float64?__
     0                              <1>  ;;; %idefalias __float64__ __?float64?__
     0                              <1> %idefalias __float80m__ __?float80m?__
     0                              <1>  ;;; %idefalias __float80m__ __?float80m?__
     0                              <1> %idefalias __float80e__ __?float80e?__
     0                              <1>  ;;; %idefalias __float80e__ __?float80e?__
     0                              <1> %idefalias __float128l__ __?float128l?__
     0                              <1>  ;;; %idefalias __float128l__ __?float128l?__
     0                              <1> %idefalias __float128h__ __?float128h?__
     0                              <1>  ;;; %idefalias __float128h__ __?float128h?__
     0                              <1> %idefalias __utf16__ __?utf16?__
     0                              <1>  ;;; %idefalias __utf16__ __?utf16?__
     0                              <1> %idefalias __utf16le__ __?utf16le?__
     0                              <1>  ;;; %idefalias __utf16le__ __?utf16le?__
     0                              <1> %idefalias __utf16be__ __?utf16be?__
     0                              <1>  ;;; %idefalias __utf16be__ __?utf16be?__
     0                              <1> %idefalias __utf32__ __?utf32?__
     0                              <1>  ;;; %idefalias __utf32__ __?utf32?__
     0                              <1> %idefalias __utf32le__ __?utf32le?__
     0                              <1>  ;;; %idefalias __utf32le__ __?utf32le?__
     0                              <1> %idefalias __utf32be__ __?utf32be?__
     0                              <1>  ;;; %idefalias __utf32be__ __?utf32be?__
     0                              <1> %idefalias __ilog2e__ __?ilog2e?__
     0                              <1>  ;;; %idefalias __ilog2e__ __?ilog2e?__
     0                              <1> %idefalias __ilog2w__ __?ilog2w?__
     0                              <1>  ;;; %idefalias __ilog2w__ __?ilog2w?__
     0                              <1> %idefalias __ilog2f__ __?ilog2f?__
     0                              <1>  ;;; %idefalias __ilog2f__ __?ilog2f?__
     0                              <1> %idefalias __ilog2c__ __?ilog2c?__
     0                              <1>  ;;; %idefalias __ilog2c__ __?ilog2c?__
     0                              <1> %define __?NASM_MAJOR?__ 2
     0                              <1>  ;;; %define __?NASM_MAJOR?__ 2
     0                              <1> %define __?NASM_MINOR?__ 15
     0                              <1>  ;;; %define __?NASM_MINOR?__ 15
     0                              <1> %define __?NASM_SUBMINOR?__ 3
     0                              <1>  ;;; %define __?NASM_SUBMINOR?__ 3
     0                              <1> %define __?NASM_PATCHLEVEL?__ 0
     0                              <1>  ;;; %define __?NASM_PATCHLEVEL?__ 0
     0                              <1> %define __?NASM_VERSION_ID?__ 0020F0300h
     0                              <1>  ;;; %define __?NASM_VERSION_ID?__ 0020F0300h
     0                              <1> %define __?NASM_VER?__ "2.15.03"
     0                              <1>  ;;; %define __?NASM_VER?__ "2.15.03"
     0                              <1> %define __?SECT?__ [section .text]
     0                              <1>  ;;; %define __?SECT?__ [section .text]
     0                              <1> %macro __?NASM_CDecl?__ 1
     0                              <1> %endmacro 
     0                              <1> %imacro export 1+.nolist
     0                              <1> [export %1]
     0                              <1> %endmacro 
     0                              <1> %imacro safeseh 1.nolist
     0                              <1> [safeseh %1]
     0                              <1> %endmacro 
     0                              <1> %define __?DATE?__ "2024-08-22"
     0                              <1>  ;;; %define __?DATE?__ "2024-08-22"
     0                              <1> %define __?DATE_NUM?__ 20240822
     0                              <1>  ;;; %define __?DATE_NUM?__ 20240822
     0                              <1> %define __?TIME?__ "02:33:56"
     0                              <1>  ;;; %define __?TIME?__ "02:33:56"
     0                              <1> %define __?TIME_NUM?__ 023356
     0                              <1>  ;;; %define __?TIME_NUM?__ 023356
     0                              <1> %define __?UTC_DATE?__ "2024-08-22"
     0                              <1>  ;;; %define __?UTC_DATE?__ "2024-08-22"
     0                              <1> %define __?UTC_DATE_NUM?__ 20240822
     0                              <1>  ;;; %define __?UTC_DATE_NUM?__ 20240822
     0                              <1> %define __?UTC_TIME?__ "09:33:56"
     0                              <1>  ;;; %define __?UTC_TIME?__ "09:33:56"
     0                              <1> %define __?UTC_TIME_NUM?__ 093356
     0                              <1>  ;;; %define __?UTC_TIME_NUM?__ 093356
     0                              <1> %define __?POSIX_TIME?__ 1724319236
     0                              <1>  ;;; %define __?POSIX_TIME?__ 1724319236
     0                              <1> %define __?OUTPUT_FORMAT?__ win64
     0                              <1>  ;;; %define __?OUTPUT_FORMAT?__ win64
     0                              <1> %define __ASM__ 1
     0                              <1>  ;;; %define __ASM__ 1
     0                              <1> %define MKF_ENGINEERING 1
     0                              <1>  ;;; %define MKF_ENGINEERING 1
     0                              <1> %define ACM_TYPE AC_BIOSAC
     0                              <1>  ;;; %define ACM_TYPE AC_BIOSAC
     0                              <1> %define MCP_SHADOW_STACK_GAP 0
     0                              <1>  ;;; %define MCP_SHADOW_STACK_GAP 0
     0                              <1> %define MCP_STACK_GAP (16 + 0)
     0                              <1>  ;;; %define MCP_STACK_GAP (16 + 0)
     1                                  ;**********************************************************************;
     2                                  ;*                                                                    *;
     3                                  ;* Intel Proprietary                                                  *;
     4                                  ;*                                                                    *;
     5                                  ;* Copyright 2021 Intel Corporation All Rights Reserved.              *;
     6                                  ;*                                                                    *;
     7                                  ;* Your use of this software is governed by the TDX Source Code       *;
     8                                  ;* LIMITED USE LICENSE.                                               *;
     9                                  ;*                                                                    *;
    10                                  ;* The Materials are provided "as is," without any express or         *;
    11                                  ;* implied warranty of any kind including warranties of               *;
    12                                  ;* merchantability, non-infringement, title, or fitness for a         *;
    13                                  ;* particular purpose.                                                *;
    14                                  ;*                                                                    *;
    15                                  ;**********************************************************************;
    16                                  
    17                                  ;---------------------------------------------------------------------------
    18                                  
    19                                  %include "AcmCom_NASM.inc"
    20                              <1> ;**********************************************************************;
    21                              <1> ;*                                                                    *;
    22                              <1> ;* Intel Proprietary                                                  *;
    23                              <1> ;*                                                                    *;
    24                              <1> ;* Copyright 2021 Intel Corporation All Rights Reserved.              *;
    25                              <1> ;*                                                                    *;
    26                              <1> ;* Your use of this software is governed by the TDX Source Code       *;
    27                              <1> ;* LIMITED USE LICENSE.                                               *;
    28                              <1> ;*                                                                    *;
    29                              <1> ;* The Materials are provided "as is," without any express or         *;
    30                              <1> ;* implied warranty of any kind including warranties of               *;
    31                              <1> ;* merchantability, non-infringement, title, or fitness for a         *;
    32                              <1> ;* particular purpose.                                                *;
    33                              <1> ;*                                                                    *;
    34                              <1> ;**********************************************************************;
    35                              <1> 
    36                              <1> %ifndef ACMCOM_EQU
    37                              <1> %define ACMCOM_EQU 0
    37                              <1>  ;;; %define ACMCOM_EQU 0
    38                              <1> 
    39                              <1> 
    40                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    41                              <1> ;                       MACROS
    42                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    43                              <1> 
    44                              <1> %define CR0_PG                             0x80000000
    44                              <1>  ;;; %define CR0_PG 0x80000000
    45                              <1> %define CR4_PAE                            0x20
    45                              <1>  ;;; %define CR4_PAE 0x20
    46                              <1> %define CR4_PSE                            0x10
    46                              <1>  ;;; %define CR4_PSE 0x10
    47                              <1> %define PAGE4K                             0x1000
    47                              <1>  ;;; %define PAGE4K 0x1000
    48                              <1> %define _1KB                               0x400
    48                              <1>  ;;; %define _1KB 0x400
    49                              <1> %define _2KB                               0x800
    49                              <1>  ;;; %define _2KB 0x800
    50                              <1> %define _4KB                               0x1000
    50                              <1>  ;;; %define _4KB 0x1000
    51                              <1> %define _4KB_MASK                          (  ~  ( _4KB - 1 ) )
    51                              <1>  ;;; %define _4KB_MASK ( ~ ( _4KB - 1 ) )
    52                              <1> %define IA32_EFER_MSR                      0xC0000080
    52                              <1>  ;;; %define IA32_EFER_MSR 0xC0000080
    53                              <1> %define LME                                0x100
    53                              <1>  ;;; %define LME 0x100
    54                              <1> %define YMM_REG_QWORDS                     4
    54                              <1>  ;;; %define YMM_REG_QWORDS 4
    55                              <1> %define LT_PUB_BASE                        0xFED30000
    55                              <1>  ;;; %define LT_PUB_BASE 0xFED30000
    56                              <1> %define _64KB                              0x10000
    56                              <1>  ;;; %define _64KB 0x10000
    57                              <1> %define LT_PRV_BASE                        0xFED20000
    57                              <1>  ;;; %define LT_PRV_BASE 0xFED20000
    58                              <1> %define BIT0                               0x1
    58                              <1>  ;;; %define BIT0 0x1
    59                              <1> %define BIT8                               0x100
    59                              <1>  ;;; %define BIT8 0x100
    60                              <1> %define BIT11                              0x800
    60                              <1>  ;;; %define BIT11 0x800
    61                              <1> %define CRASH_CODE_VALID                   0x80000000
    61                              <1>  ;;; %define CRASH_CODE_VALID 0x80000000
    62                              <1> %define MSR_CORE_THREAD_COUNT              0x35          ;Can be removed
    62                              <1>  ;;; %define MSR_CORE_THREAD_COUNT 0x35
    63                              <1> %define MSR_SMRR_PHYMASK                   0x1F3          ;Can be removed
    63                              <1>  ;;; %define MSR_SMRR_PHYMASK 0x1F3
    64                              <1> %define ACM_CODE64_SELECTOR                24
    64                              <1>  ;;; %define ACM_CODE64_SELECTOR 24
    65                              <1> %define CRASH_CODE_SW_GENERATED            0x40000000
    65                              <1>  ;;; %define CRASH_CODE_SW_GENERATED 0x40000000
    66                              <1> %define AC_BIOSAC                          0
    66                              <1>  ;;; %define AC_BIOSAC 0
    67                              <1> %define AC_SINIT                           1
    67                              <1>  ;;; %define AC_SINIT 1
    68                              <1> %define ERR_RLP_TIMEOUT                    1
    68                              <1>  ;;; %define ERR_RLP_TIMEOUT 1
    69                              <1> %define ERR_RLP_SMRR_CONFIG                3
    69                              <1>  ;;; %define ERR_RLP_SMRR_CONFIG 3
    70                              <1> %define ERR_RLP_SMRR2_CONFIG               4
    70                              <1>  ;;; %define ERR_RLP_SMRR2_CONFIG 4
    71                              <1> %define CLASS_ACM_EXIT                     7
    71                              <1>  ;;; %define CLASS_ACM_EXIT 7
    72                              <1> %define CLASS_INTERNAL_ERRORS              0x20
    72                              <1>  ;;; %define CLASS_INTERNAL_ERRORS 0x20
    73                              <1> %define ERR_SHADOW_STACK                   1
    73                              <1>  ;;; %define ERR_SHADOW_STACK 1
    74                              <1> %define MSR_IA32_BIOS_SIGN_ID              0x8B
    74                              <1>  ;;; %define MSR_IA32_BIOS_SIGN_ID 0x8B
    75                              <1> %define ERR_NO_RLP_UCODE_UPDATE            2
    75                              <1>  ;;; %define ERR_NO_RLP_UCODE_UPDATE 2
    76                              <1> %define MSR_SMRR_PHYMASK                   0x1F3
    76                              <1>  ;;; %define MSR_SMRR_PHYMASK 0x1F3
    77                              <1> %define MSR_SMRR2_PHYMASK                  0x1F7
    77                              <1>  ;;; %define MSR_SMRR2_PHYMASK 0x1F7
    78                              <1> %define MSR_SMRR2_PHYBASE                  0x1F6
    78                              <1>  ;;; %define MSR_SMRR2_PHYBASE 0x1F6
    79                              <1> %define MSR_IA32_MISC_ENABLES              0x1A0
    79                              <1>  ;;; %define MSR_IA32_MISC_ENABLES 0x1A0
    80                              <1> %define BIT18                              0x40000
    80                              <1>  ;;; %define BIT18 0x40000
    81                              <1> %define GDT_SIZE                           32
    81                              <1>  ;;; %define GDT_SIZE 32
    82                              <1> %define ACM_CODE_SELECTOR                  8
    82                              <1>  ;;; %define ACM_CODE_SELECTOR 8
    83                              <1> %define EXITAC                             3
    83                              <1>  ;;; %define EXITAC 3
    84                              <1> %define SENTER                             4
    84                              <1>  ;;; %define SENTER 4
    85                              <1> %define SEXIT                              5
    85                              <1>  ;;; %define SEXIT 5
    86                              <1> %define WAKEUP                             8
    86                              <1>  ;;; %define WAKEUP 8
    87                              <1> %define _8KB                               0x2000
    87                              <1>  ;;; %define _8KB 0x2000
    88                              <1> %define MSR_SMRR_PHYBASE                   0x1F2
    88                              <1>  ;;; %define MSR_SMRR_PHYBASE 0x1F2
    89                              <1> %define ACM_DATA_SELECTOR                  16
    89                              <1>  ;;; %define ACM_DATA_SELECTOR 16
    90                              <1> %define PORT80                             0x80
    90                              <1>  ;;; %define PORT80 0x80
    91                              <1> %define LBL_ACM                            0x1
    91                              <1>  ;;; %define LBL_ACM 0x1
    92                              <1> %define RFA_VALID                          0x8000
    92                              <1>  ;;; %define RFA_VALID 0x8000
    93                              <1> %define IDT32GATE_INIT_1                   0x8E00
    93                              <1>  ;;; %define IDT32GATE_INIT_1 0x8E00
    94                              <1> %define VACANT                             0x00
    94                              <1>  ;;; %define VACANT 0x00
    95                              <1> %define NOT_VACANT                         0x0ff
    95                              <1>  ;;; %define NOT_VACANT 0x0ff
    96                              <1> %define CR4_PGE                            (1 << 7)
    96                              <1>  ;;; %define CR4_PGE (1 << 7)
    97                              <1> %define ENTERACCS				           2
    97                              <1>  ;;; %define ENTERACCS 2
    98                              <1> %define MSR_BIOS_SE_SVN                    0x302
    98                              <1>  ;;; %define MSR_BIOS_SE_SVN 0x302
    99                              <1> %define MSR_BIOS_DONE    			       0x151
    99                              <1>  ;;; %define MSR_BIOS_DONE 0x151
   100                              <1> %define MSR_PLATFORM_INFO    			   0xCE
   100                              <1>  ;;; %define MSR_PLATFORM_INFO 0xCE
   101                              <1> %define MSR_PLATFORM_INFO_SAMPLE_PART	   (1 << 27)
   101                              <1>  ;;; %define MSR_PLATFORM_INFO_SAMPLE_PART (1 << 27)
   102                              <1> %define CR0_WP                             (1 << 16)
   102                              <1>  ;;; %define CR0_WP (1 << 16)
   103                              <1> %define CR4_PAE        					   (1 << 5)
   103                              <1>  ;;; %define CR4_PAE (1 << 5)
   104                              <1> %define CR4_PGE 					       (1 << 7)
   104                              <1>  ;;; %define CR4_PGE (1 << 7)
   105                              <1> %define CR4_LA57					       (1 << 12)
   105                              <1>  ;;; %define CR4_LA57 (1 << 12)
   106                              <1> %define CR4_SMXE                           (1 << 14)
   106                              <1>  ;;; %define CR4_SMXE (1 << 14)
   107                              <1> 
   108                              <1> %define MF_PRODUCTION      0
   108                              <1>  ;;; %define MF_PRODUCTION 0
   109                              <1> %define MF_DEBUG           (1 << 15)
   109                              <1>  ;;; %define MF_DEBUG (1 << 15)
   110                              <1> %define MF_PROD_WORTHY     0
   110                              <1>  ;;; %define MF_PROD_WORTHY 0
   111                              <1> %define MF_NOT_PROD_WORTHY (1 << 14)
   111                              <1>  ;;; %define MF_NOT_PROD_WORTHY (1 << 14)
   112                              <1> 
   113                              <1> 
   114                              <1> ; T_DATA no longer used after code changes
   115                              <1> 
   116                              <1> %define _GETSEC         db      0x0F, 0x37
   116                              <1>  ;;; %define _GETSEC db 0x0F, 0x37
   117                              <1> %define _MONITOR        db      0x0F, 0x01, 0x0C8
   117                              <1>  ;;; %define _MONITOR db 0x0F, 0x01, 0x0C8
   118                              <1> %define _MWAIT          db      0x0F, 0x01, 0x0C9
   118                              <1>  ;;; %define _MWAIT db 0x0F, 0x01, 0x0C9
   119                              <1> 
   120                              <1> ; append underscore to globals
   121                              <1> %pragma win32 gprefix _
   121                              <1>  ;;; [pragma win32 gprefix _]
   122                              <1> 
   123                              <1> %ifidn __OUTPUT_FORMAT__, win64
   124                              <1> DEFAULT REL      ; needed to instruct NASM to emit RIP-relative code
   124                              <2>  ;;; [macro] DEFAULT {REL}
     0                              <2> [default %1]
     0                              <2>  ;;; [default REL]
   125                              <1> %endif
   126                              <1> 
   127                              <1> %macro GETSEC_EXITAC 0
   128                              <1>         mov     eax, EXITAC                  ; GETSEC (EAX=3) for ExitAC
   129                              <1>         mov     ebx, %%RETURN_ADDRESS
   130                              <1>         xor     ecx, ecx
   131                              <1>         xor     edx, edx
   132                              <1>         _GETSEC
   133                              <1> %%RETURN_ADDRESS:
   134                              <1> %endmacro
   135                              <1> 
   136                              <1> %macro GETSEC_WAKEUP 0
   137                              <1>         mov     eax, WAKEUP                  ; GETSEC (EAX=8) for WAKEUP
   138                              <1>         xor     ebx, ebx
   139                              <1>         xor     ecx, ecx
   140                              <1>         xor     edx, edx
   141                              <1>         _GETSEC
   142                              <1> %endmacro
   143                              <1> 
   144                              <1> %macro GETSEC_SEXIT 0
   145                              <1>         mov     eax, SEXIT                  ; GETSEC (EAX=5) for SEXIT
   146                              <1>         xor     ebx, ebx
   147                              <1>         xor     ecx, ecx
   148                              <1>         xor     edx, edx
   149                              <1>         _GETSEC
   150                              <1> %endmacro
   151                              <1> 
   152                              <1> %macro TDATA_VAR  0
   153                              <1>         ;
   154                              <1>         ; Changing hardcoded T_DATA onto one retrieved from SINIT size
   155                              <1>         ;
   156                              <1>         mov     edi, LT_PUB_BASE + TXT.LT_SINIT_SIZE
   157                              <1>         mov     edi, DWORD [edi]    ; Get SINIT region size
   158                              <1>         add     edi, ebp
   159                              <1>         sub     edi, _64KB
   160                              <1> %endmacro
   161                              <1> %define TDATA_VAR_RET_VAL(x)  [edi + x] ; Sighting #3865476  End
   161                              <1>  ;;; %define TDATA_VAR_RET_VAL(x) [edi + x]
   162                              <1> 
   163                              <1> %macro TDATA_VAR_OFFSET_IN_EAX        1
   164                              <1>         ;
   165                              <1>         ; ebp keeps address of SINIT module in memory
   166                              <1>         ;
   167                              <1>         ; Changing hardcoded T_DATA onto one retrieved from SINIT size
   168                              <1>         ;
   169                              <1>         mov     edi, LT_PUB_BASE + TXT.LT_SINIT_SIZE
   170                              <1>         mov     eax, DWORD [edi]    ; Get SINIT region size
   171                              <1>         sub     eax, _64KB
   172                              <1>         add     eax, ebp
   173                              <1>         add     eax, %1
   174                              <1> 
   175                              <1> %endmacro
   176                              <1> 
   177                              <1> %define EDATA_VAR(x)    [ebp +  x]
   177                              <1>  ;;; %define EDATA_VAR(x) [ebp + x]
   178                              <1> 
   179                              <1> 
   180                              <1> %macro EDATA_VAR_OFFSET_IN_EAX        1
   181                              <1>         ;;
   182                              <1>         ;; ebp keeps address of SINIT module in memory
   183                              <1>         ;;
   184                              <1>         mov     eax, ebp
   185                              <1>         add     eax, %1
   186                              <1> %endmacro
   187                              <1> 
   188                              <1> %macro PROGRESS_MARK    1
   189                              <1>         push BYTE %1
   190                              <1>         call  ProgressMark
   191                              <1>         %if MKF_ENGINEERING eq 1
   192                              <1>                 %if MKF_TRACE EQ 1
   193                              <1>                         extern TraceProgress
   194                              <1>                         push DWORD %1
   195                              <1>                         call  TraceProgress
   196                              <1> 
   197                              <1>                 %endif
   198                              <1>         %endif
   199                              <1> %endmacro
   200                              <1> 
   201                              <1> %macro TRAMPOLINE_ERROR    1
   202                              <1>         %if MKF_ENGINEERING eq 1
   203                              <1>                 %if MKF_TRACE EQ 1
   204                              <1>                         extern TraceTrampolineCodeError
   205                              <1>                         push DWORD %1
   206                              <1>                         call TraceTrampolineCodeError
   207                              <1> 
   208                              <1>                 %endif
   209                              <1>         %endif
   210                              <1> %endmacro
   211                              <1> 
   212                              <1> %macro STACK_TEST_FILL_IN       0
   213                              <1> %if (MKF_ENGINEERING == 1)
   214                              <1>         mov     edi, stackStart
   215                              <1>         mov     ecx, esp
   216                              <1>         sub     ecx, stackStart
   217                              <1>         shr     ecx, 2
   218                              <1>         mov     eax, 0CCCCCCCCh
   219                              <1>         rep     stosd
   220                              <1> %endif
   221                              <1> %endmacro
   222                              <1> 
   223                              <1> 
   224                              <1> %define FILL64(H,L)     ( ( ( ( H ) - ( L ) ) / 8 ) - 1 )
   224                              <1>  ;;; %define FILL64(H,L) ( ( ( ( H ) - ( L ) ) / 8 ) - 1 )
   225                              <1> %define FILL8(H,L)      ( ( ( H ) - ( L ) ) - 1 )
   225                              <1>  ;;; %define FILL8(H,L) ( ( ( H ) - ( L ) ) - 1 )
   226                              <1> 
   227                              <1> ;%macro FILL64    2
   228                              <1> ;        exitm <( ( ( ( %1 ) - ( %2 ) ) / 8 ) - 1 ) >
   229                              <1> ;%endmacro
   230                              <1> ;
   231                              <1> ;%macro FILL8    2
   232                              <1> ;        exitm <( ( ( %1 ) - ( %2 ) ) - 1 ) >
   233                              <1> ;%endmacro
   234                              <1> 
   235                              <1> %define CR_Valid_cr                     1
   235                              <1>  ;;; %define CR_Valid_cr 1
   236                              <1> %define CR_SwGenerated_cr               1
   236                              <1>  ;;; %define CR_SwGenerated_cr 1
   237                              <1> %define CR_Res_cr                       5
   237                              <1>  ;;; %define CR_Res_cr 5
   238                              <1> %define CR_Minor_cr                     9
   238                              <1>  ;;; %define CR_Minor_cr 9
   239                              <1> %define CR_Source_cr                    1
   239                              <1>  ;;; %define CR_Source_cr 1
   240                              <1> %define CR_Major_cr                     5
   240                              <1>  ;;; %define CR_Major_cr 5
   241                              <1> %define CR_Class_cr                     6
   241                              <1>  ;;; %define CR_Class_cr 6
   242                              <1> %define CR_AcmType_cr                   4
   242                              <1>  ;;; %define CR_AcmType_cr 4
   243                              <1> 
   244                              <1> %define CR_Valid_cr_position                     31
   244                              <1>  ;;; %define CR_Valid_cr_position 31
   245                              <1> %define CR_SwGenerated_cr_position               30
   245                              <1>  ;;; %define CR_SwGenerated_cr_position 30
   246                              <1> %define CR_Res_cr_position                       25
   246                              <1>  ;;; %define CR_Res_cr_position 25
   247                              <1> %define CR_Minor_cr_position                     16
   247                              <1>  ;;; %define CR_Minor_cr_position 16
   248                              <1> %define CR_Source_cr_position                    15
   248                              <1>  ;;; %define CR_Source_cr_position 15
   249                              <1> %define CR_Major_cr_position                     10
   249                              <1>  ;;; %define CR_Major_cr_position 10
   250                              <1> %define CR_Class_cr_position                     4
   250                              <1>  ;;; %define CR_Class_cr_position 4
   251                              <1> %define CR_AcmType_cr_position                   0
   251                              <1>  ;;; %define CR_AcmType_cr_position 0
   252                              <1> 
   253                              <1> ;
   254                              <1> ; Crash register record
   255                              <1> ;
   256                              <1> ;CR      RECORD  Valid_cr:1,SwGenerated_cr:1,Res_cr:5,Minor_cr:9,Source_cr:1,Major_cr:5,Class_cr:6,AcmType_cr:4
   257                              <1> ;
   258                              <1> ; Policy control record
   259                              <1> ;
   260                              <1> ;PC      RECORD  Res2_pc:28,OWN_REQ_pc:1,CAP_EXT_pc:1,NPW_OK_pc:1,RES_pc:1
   261                              <1> 
   262                              <1> 
   263                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   264                              <1> ;                STRUCTURE DEFINITIONS
   265                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   266                              <1> 
   267                              <1> ;TXT STRUCTURE
   268                              <1> 
   269                              <1> struc TXT
   269                              <2>  ;;; [macro] struc {TXT},{0}
     0                              <2> %push
     0                              <2> %define %$strucname %1
     0                              <2>  ;;; %define [::2] %$strucname TXT
     0                              <2> [absolute %2]
     0                              <2>  ;;; [absolute 0]
     0                              <2> %$strucname:
     0                              <2>  ;;; TXT:
   270                              <1> .LT_STS:                          resq   1
   270 00000000 ????????????????    <1>  ;;; .LT_STS: resq 1
   271                              <1> ;// 0000h
   272                              <1> .LT_ESTS:                         resq   1
   272 00000008 ????????????????    <1>  ;;; .LT_ESTS: resq 1
   273                              <1> ;// 0008h
   274                              <1> .LT_THREADS_EXISTS:               resq   1
   274 00000010 ????????????????    <1>  ;;; .LT_THREADS_EXISTS: resq 1
   275                              <1> ;// 0010h
   276                              <1> .R1_0:                            resq   1
   276 00000018 ????????????????    <1>  ;;; .R1_0: resq 1
   277                              <1> ;// 0018h
   278                              <1> .LT_THREADS_JOIN:                 resq   1
   278 00000020 ????????????????    <1>  ;;; .LT_THREADS_JOIN: resq 1
   279                              <1> ;// 0020h
   280                              <1> .R1_1:                            resq   1
   280 00000028 ????????????????    <1>  ;;; .R1_1: resq 1
   281                              <1> ;// 0028h
   282                              <1> .LT_CRASH:                        resq   1
   282 00000030 ????????????????    <1>  ;;; .LT_CRASH: resq 1
   283                              <1> ;// 0030h
   284                              <1> .LT_CMD_SYS_RESET:                resq   1
   284 00000038 ????????????????    <1>  ;;; .LT_CMD_SYS_RESET: resq 1
   285                              <1> ;// 0038h
   286                              <1> .LT_CMD_OPEN_PRIVATE:             resq   1
   286 00000040 ????????????????    <1>  ;;; .LT_CMD_OPEN_PRIVATE: resq 1
   287                              <1> ;// 0040h
   288                              <1> .LT_CMD_CLOSE_PRIVATE:            resq   1
   288 00000048 ????????????????    <1>  ;;; .LT_CMD_CLOSE_PRIVATE: resq 1
   289                              <1> ;// 0048h
   290                              <1> .LT_CRASH2:                       resq   1
   290 00000050 ????????????????    <1>  ;;; .LT_CRASH2: resq 1
   291                              <1> ;// 0050h
   292                              <1> .R2_0:                            resq FILL64(0x0A0,0x50)
   292 00000058 <res 72>            <1>  ;;; .R2_0: resq ( ( ( ( 0x0A0 ) - ( 0x50 ) ) / 8 ) - 1 )
   293                              <1> .LT_SPAD:                         resq   1
   293 000000A0 ????????????????    <1>  ;;; .LT_SPAD: resq 1
   294                              <1> ;// 00A0h
   295                              <1> .R3_0:                            resq FILL64(0x100,0x0A0)
   295 000000A8 <res 88>            <1>  ;;; .R3_0: resq ( ( ( ( 0x100 ) - ( 0x0A0 ) ) / 8 ) - 1 )
   296                              <1> .LT_VER_FSBIF:                    resq   1
   296 00000100 ????????????????    <1>  ;;; .LT_VER_FSBIF: resq 1
   297                              <1> ;// 0100h
   298                              <1> .R3_1:                            resq   1
   298 00000108 ????????????????    <1>  ;;; .R3_1: resq 1
   299                              <1> ;// 0108h
   300                              <1> .LT_DIDVID:                       resq   1
   300 00000110 ????????????????    <1>  ;;; .LT_DIDVID: resq 1
   301                              <1> ;// 0110h
   302                              <1> .LT_EID:                          resq   1
   302 00000118 ????????????????    <1>  ;;; .LT_EID: resq 1
   303                              <1> ;// 0118h
   304                              <1> .R4_0:                            resq FILL64(0x200,0x118)
   304 00000120 <res 224>           <1>  ;;; .R4_0: resq ( ( ( ( 0x200 ) - ( 0x118 ) ) / 8 ) - 1 )
   305                              <1> .LT_VER_EMIF:                     resq   1
   305 00000200 ????????????????    <1>  ;;; .LT_VER_EMIF: resq 1
   306                              <1> ;// 0200h
   307                              <1> .R4_1:                            resq   1
   307 00000208 ????????????????    <1>  ;;; .R4_1: resq 1
   308                              <1> ;// 0208h
   309                              <1> .LT_CMD_LOCKMEM_CONFIG:           resq   1
   309 00000210 ????????????????    <1>  ;;; .LT_CMD_LOCKMEM_CONFIG: resq 1
   310                              <1> ;// 0210h
   311                              <1> .LT_CMD_UNLOCK_MEM_CONFIG:        resq   1
   311 00000218 ????????????????    <1>  ;;; .LT_CMD_UNLOCK_MEM_CONFIG: resq 1
   312                              <1> ;// 0218h
   313                              <1> .LT_CMD_UNLOCK_MEMORY:            resq   1
   313 00000220 ????????????????    <1>  ;;; .LT_CMD_UNLOCK_MEMORY: resq 1
   314                              <1> ;// 0220h
   315                              <1> .R4_2:                            resq   1
   315 00000228 ????????????????    <1>  ;;; .R4_2: resq 1
   316                              <1> ;// 0228h
   317                              <1> .LT_LOCK_BASE:                    resq   1
   317 00000230 ????????????????    <1>  ;;; .LT_LOCK_BASE: resq 1
   318                              <1> ;// 0230h
   319                              <1> .LT_UNLOCK_BASE:                  resq   1
   319 00000238 ????????????????    <1>  ;;; .LT_UNLOCK_BASE: resq 1
   320                              <1> ;// 0238h
   321                              <1> .R4_3:                            resq   1
   321 00000240 ????????????????    <1>  ;;; .R4_3: resq 1
   322                              <1> ;// 0240h
   323                              <1> .R4_4:                            resq   1
   323 00000248 ????????????????    <1>  ;;; .R4_4: resq 1
   324                              <1> ;// 0248h
   325                              <1> .LT_CMD_CACHE_INVALIDATE:         resq   1
   325 00000250 ????????????????    <1>  ;;; .LT_CMD_CACHE_INVALIDATE: resq 1
   326                              <1> ;// 0250h
   327                              <1> .LT_CMD_FLUSH_WB:                 resq   1
   327 00000258 ????????????????    <1>  ;;; .LT_CMD_FLUSH_WB: resq 1
   328                              <1> ;// 0258h
   329                              <1> .LT_NODMA_BASE:                   resq   1
   329 00000260 ????????????????    <1>  ;;; .LT_NODMA_BASE: resq 1
   330                              <1> ;// 0260h
   331                              <1> .LT_NODMA_SIZE:                   resq   1
   331 00000268 ????????????????    <1>  ;;; .LT_NODMA_SIZE: resq 1
   332                              <1> ;// 0268h
   333                              <1> .LT_SINIT_BASE:                   resq   1
   333 00000270 ????????????????    <1>  ;;; .LT_SINIT_BASE: resq 1
   334                              <1> ;// 0270h
   335                              <1> .LT_SINIT_SIZE:                   resq   1
   335 00000278 ????????????????    <1>  ;;; .LT_SINIT_SIZE: resq 1
   336                              <1> ;// 0278h
   337                              <1> .LT_CMD_LOCK_PMRC:                resq   1
   337 00000280 ????????????????    <1>  ;;; .LT_CMD_LOCK_PMRC: resq 1
   338                              <1> ;// 0280h
   339                              <1> .LT_CMD_UNLOCK_PMRC:              resq   1
   339 00000288 ????????????????    <1>  ;;; .LT_CMD_UNLOCK_PMRC: resq 1
   340                              <1> ;// 0288h
   341                              <1> .LT_MLE_JOIN:                     resq   1
   341 00000290 ????????????????    <1>  ;;; .LT_MLE_JOIN: resq 1
   342                              <1> ;// 0290h
   343                              <1> .R4_5:                            resq   1
   343 00000298 ????????????????    <1>  ;;; .R4_5: resq 1
   344                              <1> ;// 0298h
   345                              <1> .LT_BLOCKMAP_CAP:                 resq   1
   345 000002A0 ????????????????    <1>  ;;; .LT_BLOCKMAP_CAP: resq 1
   346                              <1> ;// 02A0h
   347                              <1> .LT_BLOCKMAP_CNF:                 resq   1
   347 000002A8 ????????????????    <1>  ;;; .LT_BLOCKMAP_CNF: resq 1
   348                              <1> ;// 02A8h
   349                              <1> .LT_BLOCKMAP_POINTER:             resq   1
   349 000002B0 ????????????????    <1>  ;;; .LT_BLOCKMAP_POINTER: resq 1
   350                              <1> ;// 02B0h
   351                              <1> .R4_6:                            resq   1
   351 000002B8 ????????????????    <1>  ;;; .R4_6: resq 1
   352                              <1> ;// 02B8h
   353                              <1> .LT_CMD_BLOCKMAP_EN:              resq   1
   353 000002C0 ????????????????    <1>  ;;; .LT_CMD_BLOCKMAP_EN: resq 1
   354                              <1> ;// 02C0h
   355                              <1> .LT_CMD_BLOCKMAP_DIS:             resq   1
   355 000002C8 ????????????????    <1>  ;;; .LT_CMD_BLOCKMAP_DIS: resq 1
   356                              <1> ;// 02C8h
   357                              <1> .LT_CMD_NODMA_CACHE_EN:           resq   1
   357 000002D0 ????????????????    <1>  ;;; .LT_CMD_NODMA_CACHE_EN: resq 1
   358                              <1> ;// 02D0h
   359                              <1> .LT_CMD_NODMA_CACHE_DIS:          resq   1
   359 000002D8 ????????????????    <1>  ;;; .LT_CMD_NODMA_CACHE_DIS: resq 1
   360                              <1> ;// 02D8h
   361                              <1> .LT_CMD_NODMA_TABLE_PROTECT_EN:   resq   1
   361 000002E0 ????????????????    <1>  ;;; .LT_CMD_NODMA_TABLE_PROTECT_EN: resq 1
   362                              <1> ;// 02E0h
   363                              <1> .LT_CMD_NODMA_TABLE_PROTECT_DIS:  resq   1
   363 000002E8 ????????????????    <1>  ;;; .LT_CMD_NODMA_TABLE_PROTECT_DIS: resq 1
   364                              <1> ;// 02E8h
   365                              <1> .LT_CMD_MEM_CONFIG_CHECKED:       resq   1
   365 000002F0 ????????????????    <1>  ;;; .LT_CMD_MEM_CONFIG_CHECKED: resq 1
   366                              <1> ;// 02F0h
   367                              <1> .R4_7:                            resq   1
   367 000002F8 ????????????????    <1>  ;;; .R4_7: resq 1
   368                              <1> ;// 02F8h
   369                              <1> .LT_HEAP_BASE:                    resq   1
   369 00000300 ????????????????    <1>  ;;; .LT_HEAP_BASE: resq 1
   370                              <1> ;// 0300h
   371                              <1> .LT_HEAP_SIZE:                    resq   1
   371 00000308 ????????????????    <1>  ;;; .LT_HEAP_SIZE: resq 1
   372                              <1> ;// 0308h
   373                              <1> .LT_MSEG_BASE:                    resq   1
   373 00000310 ????????????????    <1>  ;;; .LT_MSEG_BASE: resq 1
   374                              <1> ;// 0310h
   375                              <1> .LT_MSEG_SIZE:                    resq   1
   375 00000318 ????????????????    <1>  ;;; .LT_MSEG_SIZE: resq 1
   376                              <1> ;// 0318h
   377                              <1> .LT_SCRATCHPAD_0:                 resq   1
   377 00000320 ????????????????    <1>  ;;; .LT_SCRATCHPAD_0: resq 1
   378                              <1> ;// 0320h
   379                              <1> .LT_BIOSACMCode:                  resd   1
   379 00000328 ????????            <1>  ;;; .LT_BIOSACMCode: resd 1
   380                              <1> ;// 0328h
   381                              <1> .LT_ACM_BIOS_POLICY:              resd   1
   381 0000032C ????????            <1>  ;;; .LT_ACM_BIOS_POLICY: resd 1
   382                              <1> ;// 032ch
   383                              <1> .LT_DPR:                          resq   1
   383 00000330 ????????????????    <1>  ;;; .LT_DPR: resq 1
   384                              <1> ;// 0330h
   385                              <1> .R4_8:                            resq   1
   385 00000338 ????????????????    <1>  ;;; .R4_8: resq 1
   386                              <1> ;// 0338h
   387                              <1> .LT_FIT_STATUS:                   resq   1
   387 00000340 ????????????????    <1>  ;;; .LT_FIT_STATUS: resq 1
   388                              <1> ;// 0340h
   389                              <1> .R4_9:                            resq   1
   389 00000348 ????????????????    <1>  ;;; .R4_9: resq 1
   390                              <1> ;// 0348h
   391                              <1> .LT_INCREMENT:                    resq   1
   391 00000350 ????????????????    <1>  ;;; .LT_INCREMENT: resq 1
   392                              <1> ;// 0350h
   393                              <1> .LT_SPAD_3:                       resq   1
   393 00000358 ????????????????    <1>  ;;; .LT_SPAD_3: resq 1
   394                              <1> ;// 0358h
   395                              <1> .LT_SCRATCHPAD_4:                 resq   1
   395 00000360 ????????????????    <1>  ;;; .LT_SCRATCHPAD_4: resq 1
   396                              <1> ;// 0360h
   397                              <1> .LT_SCRATCHPAD_5:                 resq   1
   397 00000368 ????????????????    <1>  ;;; .LT_SCRATCHPAD_5: resq 1
   398                              <1> ;// 0368h
   399                              <1> .LT_INCREMENT_2:                  resq   1
   399 00000370 ????????????????    <1>  ;;; .LT_INCREMENT_2: resq 1
   400                              <1> ;// 0370h
   401                              <1> .LT_SCRATCHPAD_6:                 resq   1
   401 00000378 ????????????????    <1>  ;;; .LT_SCRATCHPAD_6: resq 1
   402                              <1> ;// 0378h
   403                              <1> .LT_CMD_OPEN_LOCALITY1:           resq   1
   403 00000380 ????????????????    <1>  ;;; .LT_CMD_OPEN_LOCALITY1: resq 1
   404                              <1> ;// 0380h
   405                              <1> .LT_CMD_CLOSE_LOCALITY1:          resq   1
   405 00000388 ????????????????    <1>  ;;; .LT_CMD_CLOSE_LOCALITY1: resq 1
   406                              <1> ;// 0388h
   407                              <1> .LT_CMD_OPEN_LOCALITY2:           resq   1
   407 00000390 ????????????????    <1>  ;;; .LT_CMD_OPEN_LOCALITY2: resq 1
   408                              <1> ;// 0390h
   409                              <1> .LT_CMD_CLOSE_LOCALITY2:          resq   1
   409 00000398 ????????????????    <1>  ;;; .LT_CMD_CLOSE_LOCALITY2: resq 1
   410                              <1> ;// 0398h
   411                              <1> .LT_CMD_OPEN_LOCALITY3:           resq   1
   411 000003A0 ????????????????    <1>  ;;; .LT_CMD_OPEN_LOCALITY3: resq 1
   412                              <1> ;// 03A0h
   413                              <1> .LT_CMD_CLOSE_LOCALITY3:          resq   1
   413 000003A8 ????????????????    <1>  ;;; .LT_CMD_CLOSE_LOCALITY3: resq 1
   414                              <1> ;// 03A8h
   415                              <1> .R5_0:                            resq FILL64(0x400,0x3A8)
   415 000003B0 <res 80>            <1>  ;;; .R5_0: resq ( ( ( ( 0x400 ) - ( 0x3A8 ) ) / 8 ) - 1 )
   416                              <1> .LT_PUBLIC_KEY:                   resq   1
   416 00000400 ????????????????    <1>  ;;; .LT_PUBLIC_KEY: resq 1
   417                              <1> ;// 0400h
   418                              <1> .R5_1:                            resq FILL64(0x608,0x400)
   418 00000408 <res 512>           <1>  ;;; .R5_1: resq ( ( ( ( 0x608 ) - ( 0x400 ) ) / 8 ) - 1 )
   419                              <1> .LT_ESTS_SET:                     resq   1
   419 00000608 ????????????????    <1>  ;;; .LT_ESTS_SET: resq 1
   420                              <1> ;// 0608h
   421                              <1> .LT_EXISTS_SET:                   resq   1
   421 00000610 ????????????????    <1>  ;;; .LT_EXISTS_SET: resq 1
   422                              <1> ;// 0610h
   423                              <1> .R5_2:                            resq   1
   423 00000618 ????????????????    <1>  ;;; .R5_2: resq 1
   424                              <1> ;// 0618h
   425                              <1> .LT_JOINS_SET:                    resq   1
   425 00000620 ????????????????    <1>  ;;; .LT_JOINS_SET: resq 1
   426                              <1> ;// 0620h
   427                              <1> .R6_0:                            resq FILL64(0x670,0x620)
   427 00000628 <res 72>            <1>  ;;; .R6_0: resq ( ( ( ( 0x670 ) - ( 0x620 ) ) / 8 ) - 1 )
   428                              <1> .LT_SCLEAN_SET:                   resq   1
   428 00000670 ????????????????    <1>  ;;; .LT_SCLEAN_SET: resq 1
   429                              <1> ;// 0670h
   430                              <1> .R7_0:                            resq FILL64(0x6A0,0x670)
   430 00000678 <res 40>            <1>  ;;; .R7_0: resq ( ( ( ( 0x6A0 ) - ( 0x670 ) ) / 8 ) - 1 )
   431                              <1> .LT_SPAD_SET:                     resq   1
   431 000006A0 ????????????????    <1>  ;;; .LT_SPAD_SET: resq 1
   432                              <1> ;// 06A0h
   433                              <1> .R8_0:                            resq FILL64(0x710,0x6A0)
   433 000006A8 <res 104>           <1>  ;;; .R8_0: resq ( ( ( ( 0x710 ) - ( 0x6A0 ) ) / 8 ) - 1 )
   434                              <1> .LT_EXISTS_CLEAR:                 resq   1
   434 00000710 ????????????????    <1>  ;;; .LT_EXISTS_CLEAR: resq 1
   435                              <1> ;// 0710h
   436                              <1> .R8_1:                            resq   1
   436 00000718 ????????????????    <1>  ;;; .R8_1: resq 1
   437                              <1> ;// 0718h
   438                              <1> .LT_JOINS_CLEAR:                  resq   1
   438 00000720 ????????????????    <1>  ;;; .LT_JOINS_CLEAR: resq 1
   439                              <1> ;// 0720h
   440                              <1> .R9_0:                            resq FILL64(0x770,0x720)
   440 00000728 <res 72>            <1>  ;;; .R9_0: resq ( ( ( ( 0x770 ) - ( 0x720 ) ) / 8 ) - 1 )
   441                              <1> .LT_SCLEAN_CLEAR:                 resq   1
   441 00000770 ????????????????    <1>  ;;; .LT_SCLEAN_CLEAR: resq 1
   442                              <1> ;// 0770h
   443                              <1> .R10_0:                           resq FILL64(0x7A0,0x770)
   443 00000778 <res 40>            <1>  ;;; .R10_0: resq ( ( ( ( 0x7A0 ) - ( 0x770 ) ) / 8 ) - 1 )
   444                              <1> .LT_SPAD_CLEAR:                   resq   1
   444 000007A0 ????????????????    <1>  ;;; .LT_SPAD_CLEAR: resq 1
   445                              <1> ;// 07A0h
   446                              <1> .R11_0:                           resq FILL64(0x800,0x7A0)
   446 000007A8 <res 88>            <1>  ;;; .R11_0: resq ( ( ( ( 0x800 ) - ( 0x7A0 ) ) / 8 ) - 1 )
   447                              <1> .LT_VER_FTIF:                     resq   1
   447 00000800 ????????????????    <1>  ;;; .LT_VER_FTIF: resq 1
   448                              <1> ;// 0800h
   449                              <1> .R11_1:                           resq   1
   449 00000808 ????????????????    <1>  ;;; .R11_1: resq 1
   450                              <1> ;// 0808h
   451                              <1> .LT_PCH_DIDVID:                   resq   1
   451 00000810 ????????????????    <1>  ;;; .LT_PCH_DIDVID: resq 1
   452                              <1> ;// 0810h
   453                              <1> .R12_0:                           resq FILL64(0x880,0x810)
   453 00000818 <res 104>           <1>  ;;; .R12_0: resq ( ( ( ( 0x880 ) - ( 0x810 ) ) / 8 ) - 1 )
   454                              <1> .LT_UCS:                          resq   1
   454 00000880 ????????????????    <1>  ;;; .LT_UCS: resq 1
   455                              <1> ;// 880h
   456                              <1> .R13_0:                           resq FILL64(0x8E0,0x880)
   456 00000888 <res 88>            <1>  ;;; .R13_0: resq ( ( ( ( 0x8E0 ) - ( 0x880 ) ) / 8 ) - 1 )
   457                              <1> .LT_CMD_SECRETS:                  resq   1
   457 000008E0 ????????????????    <1>  ;;; .LT_CMD_SECRETS: resq 1
   458                              <1> ;// 08E0h
   459                              <1> .LT_CMD_NO_SECRETS:               resq   1
   459 000008E8 ????????????????    <1>  ;;; .LT_CMD_NO_SECRETS: resq 1
   460                              <1> ;// 08E8h
   461                              <1> .LT_E2STS:                        resq   1
   461 000008F0 ????????????????    <1>  ;;; .LT_E2STS: resq 1
   462                              <1> ;// 08F0h
   463                              <1> .R13_1:                           resq   1
   463 000008F8 ????????????????    <1>  ;;; .R13_1: resq 1
   464                              <1> ;// 08F8h
   465                              <1> .LT_FT_REGS1:                     resd   1
   465 00000900 ????????            <1>  ;;; .LT_FT_REGS1: resd 1
   466                              <1> ;// 0900h
   467                              <1> .LT_FT_REGS2:                     resd   1
   467 00000904 ????????            <1>  ;;; .LT_FT_REGS2: resd 1
   468                              <1> ;// 0904h
   469                              <1> .R14_0:                           resq FILL64(0x0D80,0x900)
   469 00000908 <res 1144>          <1>  ;;; .R14_0: resq ( ( ( ( 0x0D80 ) - ( 0x900 ) ) / 8 ) - 1 )
   470                              <1> .LT_SEQ_START:                    resq   1
   470 00000D80 ????????????????    <1>  ;;; .LT_SEQ_START: resq 1
   471                              <1> ;// 0D80h
   472                              <1> .R14_2:                           resq   1
   472 00000D88 ????????????????    <1>  ;;; .R14_2: resq 1
   473                              <1> ;// 0D88h
   474                              <1> .LT_SEQ_DONE:                     resq   1
   474 00000D90 ????????????????    <1>  ;;; .LT_SEQ_DONE: resq 1
   475                              <1> ;// 0D90h
   476                              <1> .LT_INCREMENT_3:                  resq   1
   476 00000D98 ????????????????    <1>  ;;; .LT_INCREMENT_3: resq 1
   477                              <1> ;// 0D98h
   478                              <1> .LT_SCRATCHPAD_7:                 resq   1
   478 00000DA0 ????????????????    <1>  ;;; .LT_SCRATCHPAD_7: resq 1
   479                              <1> ;// 0DA0h
   480                              <1> .LT_INCREMENT_4:                  resq   1
   480 00000DA8 ????????????????    <1>  ;;; .LT_INCREMENT_4: resq 1
   481                              <1> ;// 0DA8h
   482                              <1> .LT_SCRATCHPAD_8:                 resq   1
   482 00000DB0 ????????????????    <1>  ;;; .LT_SCRATCHPAD_8: resq 1
   483                              <1> ;// 0DB0h
   484                              <1> .LT_INCREMENT_5:                  resq   1
   484 00000DB8 ????????????????    <1>  ;;; .LT_INCREMENT_5: resq 1
   485                              <1> ;// 0DB8h
   486                              <1> .LT_SCRATCHPAD_9:                 resq   1
   486 00000DC0 ????????????????    <1>  ;;; .LT_SCRATCHPAD_9: resq 1
   487                              <1> ;// 0DC0h
   488                              <1> .LT_INCREMENT_6:                  resq   1
   488 00000DC8 ????????????????    <1>  ;;; .LT_INCREMENT_6: resq 1
   489                              <1> ;// 0DC8h
   490                              <1> .LT_SCRATCHPAD_10:                resq   1
   490 00000DD0 ????????????????    <1>  ;;; .LT_SCRATCHPAD_10: resq 1
   491                              <1> ;// 0DD0h
   492                              <1> .LT_INCREMENT_7:                  resq   1
   492 00000DD8 ????????????????    <1>  ;;; .LT_INCREMENT_7: resq 1
   493                              <1> ;// 0DD8h
   494                              <1> .LT_SCRATCHPAD_11:                resq   1
   494 00000DE0 ????????????????    <1>  ;;; .LT_SCRATCHPAD_11: resq 1
   495                              <1> ;// 0DE0h
   496                              <1> .LT_INCREMENT_8:                  resq   1
   496 00000DE8 ????????????????    <1>  ;;; .LT_INCREMENT_8: resq 1
   497                              <1> ;// 0DE8h
   498                              <1> .LT_SCRATCHPAD_12:                resq   1
   498 00000DF0 ????????????????    <1>  ;;; .LT_SCRATCHPAD_12: resq 1
   499                              <1> ;// 0DF0h
   500                              <1> endstruc
   500                              <2>  ;;; [macro] endstruc
     0                              <2> %$strucname_size equ ($-%$strucname)
     0                              <2>  ;;; TXT_size equ ($-TXT)
     0                              <2> %pop
     0                              <2> __?SECT?__
     0                              <2>  ;;; [section .text]
   501                              <1> 
   502                              <1> ;MLE_JOIN STRUCTURE
   503                              <1> 
   504                              <1> struc MLE_JOIN
   504                              <2>  ;;; [macro] struc {MLE_JOIN},{0}
     0                              <2> %push
     0                              <2> %define %$strucname %1
     0                              <2>  ;;; %define [::5] %$strucname MLE_JOIN
     0                              <2> [absolute %2]
     0                              <2>  ;;; [absolute 0]
     0                              <2> %$strucname:
     0                              <2>  ;;; MLE_JOIN:
   505                              <1> .GdtLimit:                        resd 1
   505 00000000 ????????            <1>  ;;; .GdtLimit: resd 1
   506                              <1> .GdtBase:                         resd 1
   506 00000004 ????????            <1>  ;;; .GdtBase: resd 1
   507                              <1> .SegSel:                          resd 1
   507 00000008 ????????            <1>  ;;; .SegSel: resd 1
   508                              <1> .EntryPoint:                      resd 1
   508 0000000C ????????            <1>  ;;; .EntryPoint: resd 1
   509                              <1> endstruc
   509                              <2>  ;;; [macro] endstruc
     0                              <2> %$strucname_size equ ($-%$strucname)
     0                              <2>  ;;; MLE_JOIN_size equ ($-MLE_JOIN)
     0                              <2> %pop
     0                              <2> __?SECT?__
     0                              <2>  ;;; [section .text]
   510                              <1> 
   511                              <1> ;IDT64GATE STRUCTURE
   512                              <1> 
   513                              <1> struc IDT64GATE
   513                              <2>  ;;; [macro] struc {IDT64GATE},{0}
     0                              <2> %push
     0                              <2> %define %$strucname %1
     0                              <2>  ;;; %define [::8] %$strucname IDT64GATE
     0                              <2> [absolute %2]
     0                              <2>  ;;; [absolute 0]
     0                              <2> %$strucname:
     0                              <2>  ;;; IDT64GATE:
   514                              <1> .Off31_16_Attr_Sel_Off15_0:       resq   1
   514 00000000 ????????????????    <1>  ;;; .Off31_16_Attr_Sel_Off15_0: resq 1
   515                              <1> .Res_Off63_32:                    resq   1
   515 00000008 ????????????????    <1>  ;;; .Res_Off63_32: resq 1
   516                              <1> endstruc
   516                              <2>  ;;; [macro] endstruc
     0                              <2> %$strucname_size equ ($-%$strucname)
     0                              <2>  ;;; IDT64GATE_size equ ($-IDT64GATE)
     0                              <2> %pop
     0                              <2> __?SECT?__
     0                              <2>  ;;; [section .text]
   517                              <1> 
   518                              <1> ;COM_DATA STRUCTURE
   519                              <1> 
   520                              <1> struc COM_DATA
   520                              <2>  ;;; [macro] struc {COM_DATA},{0}
     0                              <2> %push
     0                              <2> %define %$strucname %1
     0                              <2>  ;;; %define [::11] %$strucname COM_DATA
     0                              <2> [absolute %2]
     0                              <2>  ;;; [absolute 0]
     0                              <2> %$strucname:
     0                              <2>  ;;; COM_DATA:
   521                              <1> .Data64Start:             resd 1 ;		      // Offset of 64-bit data start (and Code32End)
   521 00000000 ????????            <1>  ;;; .Data64Start: resd 1
   522                              <1> .Code64Start:             resd 1 ;            // Offset of 64-bit code start
   522 00000004 ????????            <1>  ;;; .Code64Start: resd 1
   523                              <1> .Code64End:               resd 1 ;            // Offset of 64-bit code end
   523 00000008 ????????            <1>  ;;; .Code64End: resd 1
   524                              <1> .Code64Entry:             resd 1 ;            // Offset of 64-bit code entry point
   524 0000000C ????????            <1>  ;;; .Code64Entry: resd 1
   525                              <1> .StkStart:                resd 1 ;            // Offset of stack start
   525 00000010 ????????            <1>  ;;; .StkStart: resd 1
   526                              <1> .Code32Start:             resd 1 ;            // Offset of code segment start.
   526 00000014 ????????            <1>  ;;; .Code32Start: resd 1
   527                              <1> endstruc
   527                              <2>  ;;; [macro] endstruc
     0                              <2> %$strucname_size equ ($-%$strucname)
     0                              <2>  ;;; COM_DATA_size equ ($-COM_DATA)
     0                              <2> %pop
     0                              <2> __?SECT?__
     0                              <2>  ;;; [section .text]
   528                              <1> 
   529                              <1> ;BIOSAC_COM64_DATA STRUCTURE
   530                              <1> 
   531                              <1> struc BIOSAC_COM64_DATA
   531                              <2>  ;;; [macro] struc {BIOSAC_COM64_DATA},{0}
     0                              <2> %push
     0                              <2> %define %$strucname %1
     0                              <2>  ;;; %define [::14] %$strucname BIOSAC_COM64_DATA
     0                              <2> [absolute %2]
     0                              <2>  ;;; [absolute 0]
     0                              <2> %$strucname:
     0                              <2>  ;;; BIOSAC_COM64_DATA:
   532                              <1> .Tolud:                   resq   1
   532 00000000 ????????????????    <1>  ;;; .Tolud: resq 1
   533                              <1> .Touud:                   resq   1
   533 00000008 ????????????????    <1>  ;;; .Touud: resq 1
   534                              <1> .AcmBase:                 resd   1
   534 00000010 ????????            <1>  ;;; .AcmBase: resd 1
   535                              <1> .AcmSize:                 resd   1
   535 00000014 ????????            <1>  ;;; .AcmSize: resd 1
   536                              <1> .PdptBase:                resd   1
   536 00000018 ????????            <1>  ;;; .PdptBase: resd 1
   537                              <1> .error64:                 resd   1
   537 0000001C ????????            <1>  ;;; .error64: resd 1
   538                              <1> .Pattern:                 resq YMM_REG_QWORDS
   538 00000020 <res 32>            <1>  ;;; .Pattern: resq 4
   539                              <1> .StrideSize               resd   1
   539 00000040 ????????            <1>  ;;; .StrideSize resd 1
   540                              <1> .Reserved                 resd   1
   540 00000044 ????????            <1>  ;;; .Reserved resd 1
   541                              <1> .shadow_stack_vesp:       resq   1
   541 00000048 ????????????????    <1>  ;;; .shadow_stack_vesp: resq 1
   542                              <1> endstruc
   542                              <2>  ;;; [macro] endstruc
     0                              <2> %$strucname_size equ ($-%$strucname)
     0                              <2>  ;;; BIOSAC_COM64_DATA_size equ ($-BIOSAC_COM64_DATA)
     0                              <2> %pop
     0                              <2> __?SECT?__
     0                              <2>  ;;; [section .text]
   543                              <1> 
   544                              <1> ;When updating below structure, make sure to update COM64_DATA structure in 
   545                              <1> ;common64.h. If they are not in sync, random sinit failures may be 
   546                              <1> ;seen during resume flows
   547                              <1> 
   548                              <1> ;COM64_DATA STRUCTURE
   549                              <1> 
   550                              <1> struc COM64_DATA
   550                              <2>  ;;; [macro] struc {COM64_DATA},{0}
     0                              <2> %push
     0                              <2> %define %$strucname %1
     0                              <2>  ;;; %define [::17] %$strucname COM64_DATA
     0                              <2> [absolute %2]
     0                              <2>  ;;; [absolute 0]
     0                              <2> %$strucname:
     0                              <2>  ;;; COM64_DATA:
   551                              <1> 
   552                              <1> .Rc6Mem:                  resq   1
   552 00000000 ????????????????    <1>  ;;; .Rc6Mem: resq 1
   553                              <1> .MediaRc6Mem              resq   1
   553 00000008 ????????????????    <1>  ;;; .MediaRc6Mem resq 1
   554                              <1> .Mdrb:                    resq   1
   554 00000010 ????????????????    <1>  ;;; .Mdrb: resq 1
   555                              <1> .Touud:                   resq   1
   555 00000018 ????????????????    <1>  ;;; .Touud: resq 1
   556                              <1> .Tolud:                   resq   1
   556 00000020 ????????????????    <1>  ;;; .Tolud: resq 1
   557                              <1> .Bgsm:                    resq   1
   557 00000028 ????????????????    <1>  ;;; .Bgsm: resq 1
   558                              <1> .Bdsm:                    resq   1
   558 00000030 ????????????????    <1>  ;;; .Bdsm: resq 1
   559                              <1> .Ggc:                     resq   1
   559 00000038 ????????????????    <1>  ;;; .Ggc: resq 1
   560                              <1> .TsegMb:                  resq   1
   560 00000040 ????????????????    <1>  ;;; .TsegMb: resq 1
   561                              <1> .Dpr:                     resq   1
   561 00000048 ????????????????    <1>  ;;; .Dpr: resq 1
   562                              <1> .Pavpc:                   resq   1
   562 00000050 ????????????????    <1>  ;;; .Pavpc: resq 1
   563                              <1> .PavpcDE                  resq   1
   563 00000058 ????????????????    <1>  ;;; .PavpcDE resq 1
   564                              <1> .PrmrrBase:               resq   1
   564 00000060 ????????????????    <1>  ;;; .PrmrrBase: resq 1
   565                              <1> .PrmrrMask:               resq   1
   565 00000068 ????????????????    <1>  ;;; .PrmrrMask: resq 1
   566                              <1> .Mpmen:                   resd   1
   566 00000070 ????????            <1>  ;;; .Mpmen: resd 1
   567                              <1> .PmrLoBase:               resd   1
   567 00000074 ????????            <1>  ;;; .PmrLoBase: resd 1
   568                              <1> .PmrLoLimit:              resd   1
   568 00000078 ????????            <1>  ;;; .PmrLoLimit: resd 1
   569                              <1> .PmrHiBase:               resd   1
   569 0000007C ????????            <1>  ;;; .PmrHiBase: resd 1
   570                              <1> .PmrHiLimit:              resd   1
   570 00000080 ????????            <1>  ;;; .PmrHiLimit: resd 1
   571                              <1> .GunitCtrl:               resd   1
   571 00000084 ????????            <1>  ;;; .GunitCtrl: resd 1
   572                              <1> .GucWopcmOffset:          resd   1
   572 00000088 ????????            <1>  ;;; .GucWopcmOffset: resd 1
   573                              <1> .GucWopcmSize:            resd   1
   573 0000008C ????????            <1>  ;;; .GucWopcmSize: resd 1
   574                              <1> .GucMediaWopcmOffset:     resd   1
   574 00000090 ????????            <1>  ;;; .GucMediaWopcmOffset: resd 1
   575                              <1> .GucMediaWopcmSize:       resd   1
   575 00000094 ????????            <1>  ;;; .GucMediaWopcmSize: resd 1
   576                              <1> .BtPol:                   resq   1
   576 00000098 ????????????????    <1>  ;;; .BtPol: resq 1
   577                              <1> .BpKey0:                  resq   1
   577 000000A0 ????????????????    <1>  ;;; .BpKey0: resq 1
   578                              <1> .BpKey1:                  resq   1
   578 000000A8 ????????????????    <1>  ;;; .BpKey1: resq 1
   579                              <1> .BpKey2:                  resq   1
   579 000000B0 ????????????????    <1>  ;;; .BpKey2: resq 1
   580                              <1> .BpKey3:                  resq   1
   580 000000B8 ????????????????    <1>  ;;; .BpKey3: resq 1
   581                              <1> .BpKey4:                  resq   1
   581 000000C0 ????????????????    <1>  ;;; .BpKey4: resq 1
   582                              <1> .BpKey5:                  resq   1
   582 000000C8 ????????????????    <1>  ;;; .BpKey5: resq 1
   583                              <1> .Pml4PageDirectoryBase:   resd   1
   583 000000D0 ????????            <1>  ;;; .Pml4PageDirectoryBase: resd 1
   584                              <1> .error64:                 resd   1
   584 000000D4 ????????            <1>  ;;; .error64: resd 1
   585                              <1> .ReqType:                 resb   1
   585 000000D8 ??                  <1>  ;;; .ReqType: resb 1
   586                              <1> .shadow_stack_vesp:       resq   1
   586 000000D9 ????????????????    <1>  ;;; .shadow_stack_vesp: resq 1
   587                              <1> endstruc
   587                              <2>  ;;; [macro] endstruc
     0                              <2> %$strucname_size equ ($-%$strucname)
     0                              <2>  ;;; COM64_DATA_size equ ($-COM64_DATA)
     0                              <2> %pop
     0                              <2> __?SECT?__
     0                              <2>  ;;; [section .text]
   588                              <1> 
   589                              <1> %if 0
   590                              <1> ;COM64_DATA STRUCTURE
   591                              <1> struc SEAMLDR_COM64_DATA
   592                              <1> 
   593                              <1> .OriginalR8:                  resq   1
   594                              <1> .OriginalR9:	              resq   1
   595                              <1> .OriginalR10:                 resq   1
   596                              <1> .OriginalR11:                 resq   1
   597                              <1> .OriginalR12:                 resq   1
   598                              <1> .OriginalCR3:                 resq   1
   599                              <1> .OriginalCR4:                 resd   1
   600                              <1> .OriginalES:                  resw   1
   601                              <1> .OriginalFS:                  resw   1
   602                              <1> .OriginalGS:                  resw   1
   603                              <1> .OriginalSS:                  resw   1
   604                              <1> .OriginalECX                  resd   1
   605                              <1> .OriginalIDTRLimit:           resw   1
   606                              <1> .NewIDTR:               	  resb   10
   607                              <1> .OriginalGdtr:                resb   10
   608                              <1> .ResumeRip:               	  resq   1
   609                              <1> .PtCtxPtr:                    resq   1
   610                              <1> .RetVal:                      resq   1
   611                              <1> .HeaderStart:                 resq   1
   612                              <1> .PseamldrSize:                resd   1
   613                              <1> .PseamldrOffset:              resq   1
   614                              <1> .PseamldrConstsOffset:     	  resq   1
   615                              <1> .NewGdtr:     				  resb   10
   616                              <1> endstruc
   617                              <1> %endif
   618                              <1> 
   619                              <1> 
   620                              <1> ;GDT32DESCRIPTOR STRUCTURE
   621                              <1> 
   622                              <1> struc GDT32DESCRIPTOR
   622                              <2>  ;;; [macro] struc {GDT32DESCRIPTOR},{0}
     0                              <2> %push
     0                              <2> %define %$strucname %1
     0                              <2>  ;;; %define [::20] %$strucname GDT32DESCRIPTOR
     0                              <2> [absolute %2]
     0                              <2>  ;;; [absolute 0]
     0                              <2> %$strucname:
     0                              <2>  ;;; GDT32DESCRIPTOR:
   623                              <1> 
   624                              <1> .Limit15_0:               resw    1
   624 00000000 ????                <1>  ;;; .Limit15_0: resw 1
   625                              <1> .Base23_0:                resb    3
   625 00000002 ??????              <1>  ;;; .Base23_0: resb 3
   626                              <1> .Attr:                    resb    1
   626 00000005 ??                  <1>  ;;; .Attr: resb 1
   627                              <1> .Attr_Limit19_16:         resb    1
   627 00000006 ??                  <1>  ;;; .Attr_Limit19_16: resb 1
   628                              <1> .Base31_24:               resb    1
   628 00000007 ??                  <1>  ;;; .Base31_24: resb 1
   629                              <1> 
   630                              <1> endstruc
   630                              <2>  ;;; [macro] endstruc
     0                              <2> %$strucname_size equ ($-%$strucname)
     0                              <2>  ;;; GDT32DESCRIPTOR_size equ ($-GDT32DESCRIPTOR)
     0                              <2> %pop
     0                              <2> __?SECT?__
     0                              <2>  ;;; [section .text]
   631                              <1> 
   632                              <1> 
   633                              <1> ;GDT STRUCTURE
   634                              <1> 
   635                              <1> struc GDT
   635                              <2>  ;;; [macro] struc {GDT},{0}
     0                              <2> %push
     0                              <2> %define %$strucname %1
     0                              <2>  ;;; %define [::23] %$strucname GDT
     0                              <2> [absolute %2]
     0                              <2>  ;;; [absolute 0]
     0                              <2> %$strucname:
     0                              <2>  ;;; GDT:
   636                              <1> 
   637                              <1> .NullDescriptor: resb GDT32DESCRIPTOR_size
   637 00000000 ????????????????    <1>  ;;; .NullDescriptor: resb GDT32DESCRIPTOR_size
   638                              <1> .AcmCodeDescriptor: resb GDT32DESCRIPTOR_size
   638 00000008 ????????????????    <1>  ;;; .AcmCodeDescriptor: resb GDT32DESCRIPTOR_size
   639                              <1> .AcmDataDescriptor: resb GDT32DESCRIPTOR_size
   639 00000010 ????????????????    <1>  ;;; .AcmDataDescriptor: resb GDT32DESCRIPTOR_size
   640                              <1> .AcmCode64Descriptor:  resb GDT32DESCRIPTOR_size
   640 00000018 ????????????????    <1>  ;;; .AcmCode64Descriptor: resb GDT32DESCRIPTOR_size
   641                              <1> 
   642                              <1> endstruc
   642                              <2>  ;;; [macro] endstruc
     0                              <2> %$strucname_size equ ($-%$strucname)
     0                              <2>  ;;; GDT_size equ ($-GDT)
     0                              <2> %pop
     0                              <2> __?SECT?__
     0                              <2>  ;;; [section .text]
   643                              <1> 
   644                              <1> ;RANGE STRUCTURE
   645                              <1> 
   646                              <1> struc RANGE
   646                              <2>  ;;; [macro] struc {RANGE},{0}
     0                              <2> %push
     0                              <2> %define %$strucname %1
     0                              <2>  ;;; %define [::26] %$strucname RANGE
     0                              <2> [absolute %2]
     0                              <2>  ;;; [absolute 0]
     0                              <2> %$strucname:
     0                              <2>  ;;; RANGE:
   647                              <1> 
   648                              <1> .labl:                    resq   1
   648 00000000 ????????????????    <1>  ;;; .labl: resq 1
   649                              <1> .attr:                    resw   1
   649 00000008 ????                <1>  ;;; .attr: resw 1
   650                              <1> .flags:                   resw   1
   650 0000000A ????                <1>  ;;; .flags: resw 1
   651                              <1> .len:                     resq   1
   651 0000000C ????????????????    <1>  ;;; .len: resq 1
   652                              <1> .base:                    resq   1
   652 00000014 ????????????????    <1>  ;;; .base: resq 1
   653                              <1> .top:                     resq   1
   653 0000001C ????????????????    <1>  ;;; .top: resq 1
   654                              <1> .almtMask:                resq   1
   654 00000024 ????????????????    <1>  ;;; .almtMask: resq 1
   655                              <1> 
   656                              <1> endstruc
   656                              <2>  ;;; [macro] endstruc
     0                              <2> %$strucname_size equ ($-%$strucname)
     0                              <2>  ;;; RANGE_size equ ($-RANGE)
     0                              <2> %pop
     0                              <2> __?SECT?__
     0                              <2>  ;;; [section .text]
   657                              <1> 
   658                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   659                              <1> ;                       DUMMYS FOR ACM HEADER
   660                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   661                              <1> 
   662                              <1> struc   Dummy_1
   662                              <2>  ;;; [macro] struc {Dummy_1},{0}
     0                              <2> %push
     0                              <2> %define %$strucname %1
     0                              <2>  ;;; %define [::29] %$strucname Dummy_1
     0                              <2> [absolute %2]
     0                              <2>  ;;; [absolute 0]
     0                              <2> %$strucname:
     0                              <2>  ;;; Dummy_1:
   663                              <1>         .HeaderLen               resd   1
   663 00000000 ????????            <1>  ;;;  .HeaderLen resd 1
   664                              <1>         .HeaderVersion           resd   1
   664 00000004 ????????            <1>  ;;;  .HeaderVersion resd 1
   665                              <1> endstruc
   665                              <2>  ;;; [macro] endstruc
     0                              <2> %$strucname_size equ ($-%$strucname)
     0                              <2>  ;;; Dummy_1_size equ ($-Dummy_1)
     0                              <2> %pop
     0                              <2> __?SECT?__
     0                              <2>  ;;; [section .text]
   666                              <1> 
   667                              <1> struc   Dummy_2
   667                              <2>  ;;; [macro] struc {Dummy_2},{0}
     0                              <2> %push
     0                              <2> %define %$strucname %1
     0                              <2>  ;;; %define [::32] %$strucname Dummy_2
     0                              <2> [absolute %2]
     0                              <2>  ;;; [absolute 0]
     0                              <2> %$strucname:
     0                              <2>  ;;; Dummy_2:
   668                              <1>         .ModuleVendor            resd   1
   668 00000000 ????????            <1>  ;;;  .ModuleVendor resd 1
   669                              <1>         .Revision                resd   1
   669 00000004 ????????            <1>  ;;;  .Revision resd 1
   670                              <1>         .Sizeb                   resd   1
   670 00000008 ????????            <1>  ;;;  .Sizeb resd 1
   671                              <1> endstruc
   671                              <2>  ;;; [macro] endstruc
     0                              <2> %$strucname_size equ ($-%$strucname)
     0                              <2>  ;;; Dummy_2_size equ ($-Dummy_2)
     0                              <2> %pop
     0                              <2> __?SECT?__
     0                              <2>  ;;; [section .text]
   672                              <1> 
   673                              <1> struc   Dummy_3
   673                              <2>  ;;; [macro] struc {Dummy_3},{0}
     0                              <2> %push
     0                              <2> %define %$strucname %1
     0                              <2>  ;;; %define [::35] %$strucname Dummy_3
     0                              <2> [absolute %2]
     0                              <2>  ;;; [absolute 0]
     0                              <2> %$strucname:
     0                              <2>  ;;; Dummy_3:
   674                              <1>         .CodeControl             resd   1
   674 00000000 ????????            <1>  ;;;  .CodeControl resd 1
   675                              <1>         .ErrorEntryPoint         resd   1
   675 00000004 ????????            <1>  ;;;  .ErrorEntryPoint resd 1
   676                              <1> endstruc
   676                              <2>  ;;; [macro] endstruc
     0                              <2> %$strucname_size equ ($-%$strucname)
     0                              <2>  ;;; Dummy_3_size equ ($-Dummy_3)
     0                              <2> %pop
     0                              <2> __?SECT?__
     0                              <2>  ;;; [section .text]
   677                              <1> 
   678                              <1> struc   Dummy_4
   678                              <2>  ;;; [macro] struc {Dummy_4},{0}
     0                              <2> %push
     0                              <2> %define %$strucname %1
     0                              <2>  ;;; %define [::38] %$strucname Dummy_4
     0                              <2> [absolute %2]
     0                              <2>  ;;; [absolute 0]
     0                              <2> %$strucname:
     0                              <2>  ;;; Dummy_4:
   679                              <1>         .Reserved2               resb   64
   679 00000000 <res 64>            <1>  ;;;  .Reserved2 resb 64
   680                              <1>         .KeySize                 resd   1
   680 00000040 ????????            <1>  ;;;  .KeySize resd 1
   681                              <1>         .ScratchSize             resd   1
   681 00000044 ????????            <1>  ;;;  .ScratchSize resd 1
   682                              <1>         .RSA2048PubKey           resb   256
   682 00000048 <res 256>           <1>  ;;;  .RSA2048PubKey resb 256
   683                              <1>         .PubExp                  resd   1
   683 00000148 ????????            <1>  ;;;  .PubExp resd 1
   684                              <1>         .RSA2048Sig              resb   256
   684 0000014C <res 256>           <1>  ;;;  .RSA2048Sig resb 256
   685                              <1>         .scratch                 resb   572
   685 0000024C <res 572>           <1>  ;;;  .scratch resb 572
   686                              <1> endstruc
   686                              <2>  ;;; [macro] endstruc
     0                              <2> %$strucname_size equ ($-%$strucname)
     0                              <2>  ;;; Dummy_4_size equ ($-Dummy_4)
     0                              <2> %pop
     0                              <2> __?SECT?__
     0                              <2>  ;;; [section .text]
   687                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   688                              <1> 
   689                              <1> 
   690                              <1> 
   691                              <1> ;ACM_HEADER STRUCTURE
   692                              <1> struc ACM_HEADER_0
   692                              <2>  ;;; [macro] struc {ACM_HEADER_0},{0}
     0                              <2> %push
     0                              <2> %define %$strucname %1
     0                              <2>  ;;; %define [::41] %$strucname ACM_HEADER_0
     0                              <2> [absolute %2]
     0                              <2>  ;;; [absolute 0]
     0                              <2> %$strucname:
     0                              <2>  ;;; ACM_HEADER_0:
   693                              <1> 
   694                              <1> .ModuleType                             resw    1
   694 00000000 ????                <1>  ;;; .ModuleType resw 1
   695                              <1> .ModuleSubType                          resw    1
   695 00000002 ????                <1>  ;;; .ModuleSubType resw 1
   696                              <1> .Dummy_1_var                            resb    Dummy_1_size
   696 00000004 ????????????????    <1>  ;;; .Dummy_1_var resb Dummy_1_size
   697                              <1> .ModuleID                               resw    1
   697 0000000C ????                <1>  ;;; .ModuleID resw 1
   698                              <1> .ModuleFlags                            resw    1
   698 0000000E ????                <1>  ;;; .ModuleFlags resw 1
   699                              <1> .Dummy_2_var                            resb    Dummy_2_size
   699 00000010 <res 12>            <1>  ;;; .Dummy_2_var resb Dummy_2_size
   700                              <1> .AcmSvn                                 resw    1
   700 0000001C ????                <1>  ;;; .AcmSvn resw 1
   701                              <1> .SeSvn                                  resw    1
   701 0000001E ????                <1>  ;;; .SeSvn resw 1
   702                              <1> .Dummy_3_var                            resb    Dummy_3_size
   702 00000020 ????????????????    <1>  ;;; .Dummy_3_var resb Dummy_3_size
   703                              <1> .GDTSize                                resd    1
   703 00000028 ????????            <1>  ;;; .GDTSize resd 1
   704                              <1> .GDTBasePtr                             resd    1
   704 0000002C ????????            <1>  ;;; .GDTBasePtr resd 1
   705                              <1> .SegSel                                 resd    1
   705 00000030 ????????            <1>  ;;; .SegSel resd 1
   706                              <1> .EntryPoint                             resd    1
   706 00000034 ????????            <1>  ;;; .EntryPoint resd 1
   707                              <1> .Dummy_4_var                            resb    Dummy_4_size
   707 00000038 <res 1160>          <1>  ;;; .Dummy_4_var resb Dummy_4_size
   708                              <1> 
   709                              <1> endstruc
   709                              <2>  ;;; [macro] endstruc
     0                              <2> %$strucname_size equ ($-%$strucname)
     0                              <2>  ;;; ACM_HEADER_0_size equ ($-ACM_HEADER_0)
     0                              <2> %pop
     0                              <2> __?SECT?__
     0                              <2>  ;;; [section .text]
   710                              <1> ;IDT32GATE STRUCTURE
   711                              <1> 
   712                              <1> struc IDT32GATE
   712                              <2>  ;;; [macro] struc {IDT32GATE},{0}
     0                              <2> %push
     0                              <2> %define %$strucname %1
     0                              <2>  ;;; %define [::44] %$strucname IDT32GATE
     0                              <2> [absolute %2]
     0                              <2>  ;;; [absolute 0]
     0                              <2> %$strucname:
     0                              <2>  ;;; IDT32GATE:
   713                              <1> 
   714                              <1> .Off15_0:                 resw    1
   714 00000000 ????                <1>  ;;; .Off15_0: resw 1
   715                              <1> .Sel:                     resw    1
   715 00000002 ????                <1>  ;;; .Sel: resw 1
   716                              <1> .Attr:                    resw    1
   716 00000004 ????                <1>  ;;; .Attr: resw 1
   717                              <1> .Off31_16:                resw    1
   717 00000006 ????                <1>  ;;; .Off31_16: resw 1
   718                              <1> 
   719                              <1> endstruc
   719                              <2>  ;;; [macro] endstruc
     0                              <2> %$strucname_size equ ($-%$strucname)
     0                              <2>  ;;; IDT32GATE_size equ ($-IDT32GATE)
     0                              <2> %pop
     0                              <2> __?SECT?__
     0                              <2>  ;;; [section .text]
   720                              <1> 
   721                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   722                              <1> ;                       FUNCTION PROTOTYPES
   723                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   724                              <1> 
   725                              <1> extern fillMemory
   725                              <2>  ;;; [macro] extern {fillMemory}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern fillMemory]
     0                              <3> %rotate 1
   726                              <1> extern CoreBuildPml4TablesShort
   726                              <2>  ;;; [macro] extern {CoreBuildPml4TablesShort}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern CoreBuildPml4TablesShort]
     0                              <3> %rotate 1
   727                              <1> extern AcmEntryPoint
   727                              <2>  ;;; [macro] extern {AcmEntryPoint}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern AcmEntryPoint]
     0                              <3> %rotate 1
   728                              <1> extern CoreBuildPml4Tables
   728                              <2>  ;;; [macro] extern {CoreBuildPml4Tables}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern CoreBuildPml4Tables]
     0                              <3> %rotate 1
   729                              <1> extern copyMemory
   729                              <2>  ;;; [macro] extern {copyMemory}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern copyMemory]
     0                              <3> %rotate 1
   730                              <1> extern __Wait1ms
   730                              <2>  ;;; [macro] extern {__Wait1ms}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern __Wait1ms]
     0                              <3> %rotate 1
   731                              <1> extern INTErrorHandler
   731                              <2>  ;;; [macro] extern {INTErrorHandler}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern INTErrorHandler]
     0                              <3> %rotate 1
   732                              <1> extern Update_CRx
   732                              <2>  ;;; [macro] extern {Update_CRx}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern Update_CRx]
     0                              <3> %rotate 1
   733                              <1> extern SgxProtection
   733                              <2>  ;;; [macro] extern {SgxProtection}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern SgxProtection]
     0                              <3> %rotate 1
   734                              <1> extern commonAcmEntryPoint
   734                              <2>  ;;; [macro] extern {commonAcmEntryPoint}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern commonAcmEntryPoint]
     0                              <3> %rotate 1
   735                              <1> 
   736                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   737                              <1> ;                       EXTERN VARIABLES
   738                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   739                              <1> 
   740                              <1> extern BiosacCom64Data
   740                              <2>  ;;; [macro] extern {BiosacCom64Data}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern BiosacCom64Data]
     0                              <3> %rotate 1
   741                              <1> extern Com64Data
   741                              <2>  ;;; [macro] extern {Com64Data}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern Com64Data]
     0                              <3> %rotate 1
   742                              <1> extern AcmBase
   742                              <2>  ;;; [macro] extern {AcmBase}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern AcmBase]
     0                              <3> %rotate 1
   743                              <1> extern stackStart
   743                              <2>  ;;; [macro] extern {stackStart}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern stackStart]
     0                              <3> %rotate 1
   744                              <1> extern GdtBasePtr
   744                              <2>  ;;; [macro] extern {GdtBasePtr}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern GdtBasePtr]
     0                              <3> %rotate 1
   745                              <1> extern monitorField
   745                              <2>  ;;; [macro] extern {monitorField}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern monitorField]
     0                              <3> %rotate 1
   746                              <1> extern ilpSmrrBase
   746                              <2>  ;;; [macro] extern {ilpSmrrBase}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern ilpSmrrBase]
     0                              <3> %rotate 1
   747                              <1> extern ilpSmrrMask
   747                              <2>  ;;; [macro] extern {ilpSmrrMask}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern ilpSmrrMask]
     0                              <3> %rotate 1
   748                              <1> extern ilpSmrr2Base
   748                              <2>  ;;; [macro] extern {ilpSmrr2Base}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern ilpSmrr2Base]
     0                              <3> %rotate 1
   749                              <1> extern ilpSmrr2Mask
   749                              <2>  ;;; [macro] extern {ilpSmrr2Mask}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern ilpSmrr2Mask]
     0                              <3> %rotate 1
   750                              <1> extern ilpSmrr2Support
   750                              <2>  ;;; [macro] extern {ilpSmrr2Support}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern ilpSmrr2Support]
     0                              <3> %rotate 1
   751                              <1> extern LocalitiesToCheck
   751                              <2>  ;;; [macro] extern {LocalitiesToCheck}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern LocalitiesToCheck]
     0                              <3> %rotate 1
   752                              <1> extern BspMcuVer
   752                              <2>  ;;; [macro] extern {BspMcuVer}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern BspMcuVer]
     0                              <3> %rotate 1
   753                              <1> extern MlePageTabPhy
   753                              <2>  ;;; [macro] extern {MlePageTabPhy}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern MlePageTabPhy]
     0                              <3> %rotate 1
   754                              <1> extern MleEntryPointPhy
   754                              <2>  ;;; [macro] extern {MleEntryPointPhy}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern MleEntryPointPhy]
     0                              <3> %rotate 1
   755                              <1> extern CodeSegmentStart
   755                              <2>  ;;; [macro] extern {CodeSegmentStart}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern CodeSegmentStart]
     0                              <3> %rotate 1
   756                              <1> extern AcmSize
   756                              <2>  ;;; [macro] extern {AcmSize}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern AcmSize]
     0                              <3> %rotate 1
   757                              <1> extern AcmTop
   757                              <2>  ;;; [macro] extern {AcmTop}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern AcmTop]
     0                              <3> %rotate 1
   758                              <1> extern OriginalIDTR
   758                              <2>  ;;; [macro] extern {OriginalIDTR}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern OriginalIDTR]
     0                              <3> %rotate 1
   759                              <1> extern OriginalEIP
   759                              <2>  ;;; [macro] extern {OriginalEIP}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern OriginalEIP]
     0                              <3> %rotate 1
   760                              <1> extern OriginalEAX
   760                              <2>  ;;; [macro] extern {OriginalEAX}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern OriginalEAX]
     0                              <3> %rotate 1
   761                              <1> extern OriginalESI
   761                              <2>  ;;; [macro] extern {OriginalESI}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern OriginalESI]
     0                              <3> %rotate 1
   762                              <1> extern OriginalEDI
   762                              <2>  ;;; [macro] extern {OriginalEDI}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern OriginalEDI]
     0                              <3> %rotate 1
   763                              <1> extern OriginalECX
   763                              <2>  ;;; [macro] extern {OriginalECX}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern OriginalECX]
     0                              <3> %rotate 1
   764                              <1> extern OriginalEDX
   764                              <2>  ;;; [macro] extern {OriginalEDX}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern OriginalEDX]
     0                              <3> %rotate 1
   765                              <1> extern OriginalCR4
   765                              <2>  ;;; [macro] extern {OriginalCR4}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern OriginalCR4]
     0                              <3> %rotate 1
   766                              <1> extern OriginalES
   766                              <2>  ;;; [macro] extern {OriginalES}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern OriginalES]
     0                              <3> %rotate 1
   767                              <1> extern OriginalFS
   767                              <2>  ;;; [macro] extern {OriginalFS}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern OriginalFS]
     0                              <3> %rotate 1
   768                              <1> extern OriginalGS
   768                              <2>  ;;; [macro] extern {OriginalGS}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern OriginalGS]
     0                              <3> %rotate 1
   769                              <1> extern OriginalSS
   769                              <2>  ;;; [macro] extern {OriginalSS}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern OriginalSS]
     0                              <3> %rotate 1
   770                              <1> extern SeamldrCom64Data
   770                              <2>  ;;; [macro] extern {SeamldrCom64Data}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern SeamldrCom64Data]
     0                              <3> %rotate 1
   771                              <1> extern OriginalIDTRLimit
   771                              <2>  ;;; [macro] extern {OriginalIDTRLimit}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern OriginalIDTRLimit]
     0                              <3> %rotate 1
   772                              <1> extern HeaderStart
   772                              <2>  ;;; [macro] extern {HeaderStart}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern HeaderStart]
     0                              <3> %rotate 1
   773                              <1> extern shadow_stack_vesp
   773                              <2>  ;;; [macro] extern {shadow_stack_vesp}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern shadow_stack_vesp]
     0                              <3> %rotate 1
   774                              <1> extern shadow_stack_vesp64
   774                              <2>  ;;; [macro] extern {shadow_stack_vesp64}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern shadow_stack_vesp64]
     0                              <3> %rotate 1
   775                              <1> extern shadow_stack_vesp64_bottom
   775                              <2>  ;;; [macro] extern {shadow_stack_vesp64_bottom}
     0                              <2> %rep %0
     0                              <2> [extern %1]
     0                              <2> %rotate 1
     0                              <2> %endrep
     0                              <3> [extern %1]
     0                              <3>  ;;; [extern shadow_stack_vesp64_bottom]
     0                              <3> %rotate 1
   776                              <1> 
   777                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   778                              <1> ;                       Helper macros
   779                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   780                              <1> 
   781                              <1> 
   782                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   783                              <1> ;            Implementation of if and else Macros
   784                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   785                              <1> 
   786                              <1> %macro IF 1
   787                              <1> 
   788                              <1>         %push IF
   789                              <1>         j%-1  %$ifnot
   790                              <1> 
   791                              <1> %endmacro
   792                              <1> 
   793                              <1> %macro ELSE 0
   794                              <1> 
   795                              <1>   %ifctx IF
   796                              <1>         %repl   else
   797                              <1>         jmp     %$ifend
   798                              <1>         %$ifnot:
   799                              <1>   %else
   800                              <1>         %error  "expected IF before ELSE"
   801                              <1>   %endif
   802                              <1> 
   803                              <1> %endmacro
   804                              <1> 
   805                              <1> %macro ENDIF 0
   806                              <1> 
   807                              <1>   %ifctx IF
   808                              <1>         %$ifnot:
   809                              <1>         %pop
   810                              <1>   %elifctx  else
   811                              <1>         %$ifend:
   812                              <1>         %pop
   813                              <1>   %else
   814                              <1>         %error  "expected IF or ELSE before ENDIF"
   815                              <1>   %endif
   816                              <1> 
   817                              <1> %endmacro
   818                              <1> 
   819                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   820                              <1> ;  Implementation of Repeat Macro
   821                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   822                              <1> 
   823                              <1> %macro REPEAT 0
   824                              <1> 
   825                              <1>     %push   REPEAT
   826                              <1>     %$begin:
   827                              <1> 
   828                              <1> %endmacro
   829                              <1> 
   830                              <1> %macro UNTIL_FOREVER 0
   831                              <1>         jmp    %$begin
   832                              <1> %$break:
   833                              <1>     %pop
   834                              <1> 
   835                              <1> %endmacro
   836                              <1> 
   837                              <1> %macro UNTIL 3
   838                              <1>         cmp %1,%3
   839                              <1>         j%-2    %$begin
   840                              <1> %$break:
   841                              <1>     %pop
   842                              <1> 
   843                              <1> %endmacro
   844                              <1> 
   845                              <1> %macro UNTILCXZ 0
   846                              <1> 
   847                              <1>         loop    %$begin
   848                              <1> %$break:
   849                              <1>     %pop
   850                              <1> 
   851                              <1> %endmacro
   852                              <1> 
   853                              <1> %macro UNTILCXNZ 0
   854                              <1> 
   855                              <1>         loop    %$begin
   856                              <1> %$break:
   857                              <1>     %pop
   858                              <1> 
   859                              <1> %endmacro
   860                              <1> 
   861                              <1> 
   862                              <1> %macro BREAK_IF_EQUAL 2
   863                              <1> 	%ifctx REPEAT
   864                              <1>                 cmp %1,%2
   865                              <1>                 je %$break
   866                              <1> 	%else
   867                              <1> 		%fatal "BREAK_IF must be inside REPEAT"
   868                              <1> 	%endif
   869                              <1> %endmacro
   870                              <1> 
   871                              <1> %macro BREAK_IF_NOTEQUAL 2
   872                              <1> 	%ifctx REPEAT
   873                              <1>                 cmp %1,%2
   874                              <1>                 jne %$break
   875                              <1> 	%else
   876                              <1> 		%fatal "BREAK_IF must be inside REPEAT"
   877                              <1> 	%endif
   878                              <1> %endmacro
   879                              <1> 
   880                              <1> %macro BREAK_IF_ZERO 0
   881                              <1> 	%ifctx REPEAT
   882                              <1>                 je %$break
   883                              <1> 	%else
   884                              <1> 		%fatal "BREAK_IF must be inside REPEAT"
   885                              <1> 	%endif
   886                              <1> %endmacro
   887                              <1> 
   888                              <1> %macro BREAK_IF_NOT_ZERO 0
   889                              <1> 	%ifctx REPEAT
   890                              <1>                 jne %$break
   891                              <1> 	%else
   892                              <1> 		%fatal "BREAK_IF must be inside REPEAT"
   893                              <1> 	%endif
   894                              <1> %endmacro
   895                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   896                              <1> ;  Implementation of MULTIPUSH and MULTIPOP Macro
   897                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   898                              <1> 
   899                              <1> 
   900                              <1> %macro  MULTIPUSH 1-*
   901                              <1> 
   902                              <1>   %rep  %0
   903                              <1>         push    %1
   904                              <1>   %rotate 1
   905                              <1>   %endrep
   906                              <1> 
   907                              <1> %endmacro
   908                              <1> 
   909                              <1> %macro  MULTIPOP 1-*
   910                              <1> 
   911                              <1>   %rep %0
   912                              <1>   %rotate -1
   913                              <1>         pop     %1
   914                              <1>   %endrep
   915                              <1> 
   916                              <1> %endmacro
   917                              <1> 
   918                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   919                              <1> ;  Implementation of PROLOGUE and EPILOGUE  Macro
   920                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   921                              <1> %macro  PROLOGUE 1
   922                              <1>         push    ebp
   923                              <1>         mov     ebp,esp
   924                              <1>         sub     esp,%1
   925                              <1> %endmacro
   926                              <1> 
   927                              <1> %macro  PROLOGUE 0
   928                              <1>         push    ebp
   929                              <1>         mov     ebp,esp
   930                              <1> %endmacro
   931                              <1> 
   932                              <1> %macro  EPILOGUE  0
   933                              <1>         leave
   934                              <1>         ret
   935                              <1> %endmacro
   936                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   937                              <1> ;  Implementation of DEBUG_BREAK_POINT Macro define DEBUG before using
   938                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   939                              <1> 
   940                              <1> %ifdef DEBUG
   941                              <1> 
   942                              <1> %macro DEBUG_BREAK_POINT 0
   943                              <1>         jmp     $
   944                              <1> %endmacro
   945                              <1> 
   946                              <1> %macro PRINT_TO_PORT 1
   947                              <1>         push ax
   948                              <1>         mov ax, %1
   949                              <1>         out PORT80, ax
   950                              <1>         pop ax
   951                              <1> %endmacro
   952                              <1> 
   953                              <1> %else
   954                              <1> %macro DEBUG_BREAK_POINT  0
   955                              <1> %endmacro
   956                              <1> 
   957                              <1> %macro PRINT_TO_PORT 1
   958                              <1> %endmacro
   959                              <1> 
   960                              <1> %endif
   961                              <1> 
   962                              <1> %endif
    20                                  
    21                                  
    22                                  segment .data  align=16
    22                              <1>  ;;; [macro] segment {.data align=16}
     0                              <1> %define __?SECT?__ [segment %1]
     0                              <1>  ;;; %define __?SECT?__ [segment .data align=16]
     0                              <1> __?SECT?__
     0                              <1>  ;;; [segment .data align=16]
    23                                  
    24                                  segment .text  align=16
    24                              <1>  ;;; [macro] segment {.text align=16}
     0                              <1> %define __?SECT?__ [segment %1]
     0                              <1>  ;;; %define __?SECT?__ [segment .text align=16]
     0                              <1> __?SECT?__
     0                              <1>  ;;; [segment .text align=16]
    25                                  
    26                                  ;-----------------------------------------------------------------------------
    27                                  ;-----------------------------------------------------------------------------
    28                                  ;  Procedure:	Movdir64B
    29                                  ; 
    30                                  ;  Input:	Source
    31                                  ;           Destination
    32                                  ; 
    33                                  ;  Output:	None
    34                                  ; 
    35                                  ;  Description:  Wrapper for a MOVDIR64B instruction
    36                                  ; 
    37                                  ;-----------------------------------------------------------------------------
    38                                  ;-----------------------------------------------------------------------------
    39                                  global Movdir64B
    39                              <1>  ;;; [macro] global {Movdir64B}
     0                              <1> %rep %0
     0                              <1> [global %1]
     0                              <1> %rotate 1
     0                              <1> %endrep
     0                              <2> [global %1]
     0                              <2>  ;;; [global Movdir64B]
     0                              <2> %rotate 1
    40                                  Movdir64B :
    40                                   ;;; Movdir64B :
    41                                      push       rdi
    41 00000000 57                       ;;;  push rdi
    42                                      push       rsi
    42 00000001 56                       ;;;  push rsi
    43                                      
    44                                      mov        rdi, rcx
    44 00000002 4889CF                   ;;;  mov rdi, rcx
    45                                      mov        rsi, rdx
    45 00000005 4889D6                   ;;;  mov rsi, rdx
    46                                  ;/*movdir64b op*/
    47                                      DB 066h
    47 00000008 66                       ;;;  DB 066h
    48                                      DB 0Fh
    48 00000009 0F                       ;;;  DB 0Fh
    49                                      DB 038h
    49 0000000A 38                       ;;;  DB 038h
    50                                      DB 0F8h
    50 0000000B F8                       ;;;  DB 0F8h
    51                                  ;/*ModRM = RDI->RSI*/
    52                                      DB 037h
    52 0000000C 37                       ;;;  DB 037h
    53                                      
    54                                      pop        rsi
    54 0000000D 5E                       ;;;  pop rsi
    55                                      pop        rdi
    55 0000000E 5F                       ;;;  pop rdi
    56                                      
    57                                      ret
    57 0000000F C3                       ;;;  ret
    58                                  
    59                                  
    60                                          
    61                                  
    62                                   
